
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.datajoint.com/how-to/migrate-to-v20/">
      
      
        <link rel="prev" href="../garbage-collection/">
      
      
        <link rel="next" href="../alter-tables/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/company-logo-blue.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Migrate to 2.0 - DataJoint Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto Slab";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
	<script
		src="https://www.datadoghq-browser-agent.com/us1/v4/datadog-rum.js"
		type="text/javascript">
	</script>
	<script>
		window.DD_RUM && window.DD_RUM.init({
			clientToken: 'pub10d7870188992f8c006cf7ba1f160a3f',
			applicationId: '36a4de35-5eaa-435a-8c56-048c1b4d5d8c',
			site: 'datadoghq.com',
			service: 'datajoint-docs',
			env: 'production',
			sessionSampleRate: 100,
			sessionReplaySampleRate: 100,
			trackUserInteractions: true,
			trackResources: true,
			trackLongTasks: true,
			defaultPrivacyLevel: 'mask-user-input',
		});

		window.DD_RUM &&
		window.DD_RUM.startSessionReplayRecording();
	</script>
  
  <!-- Add scripts that need to run afterwards here -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="datajoint" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#migrate-to-datajoint-20" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  <div class="md-banner">
    <div class="md-banner__inner md-grid md-typeset">
      <p>
        ðŸ“– You are viewing documentation for <strong>DataJoint 2.0+</strong>
        Â·
        <a href="https://docs.datajoint.com/how-to/migrate-to-v20/">
          Migration guide for legacy users (pre-2.0)
        </a>
      </p>
    </div>
  </div>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DataJoint Documentation" class="md-header__button md-logo" aria-label="DataJoint Documentation" data-md-component="logo">
      
  
  <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 15.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="260.479px" height="365.463px" viewBox="0 0 260.479 365.463" enable-background="new 0 0 260.479 365.463"
	 xml:space="preserve">
<g>
	<path d="M4.638,361.434c0,0,124.071-124.072,135.896-357.434c0,0,29.555,189.053,115.266,256.988
		C255.799,260.988,173.038,249.174,4.638,361.434z"/>
</g>
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DataJoint Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Migrate to 2.0
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="datajoint" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/datajoint/datajoint-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    datajoint/datajoint-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DataJoint Documentation" class="md-nav__button md-logo" aria-label="DataJoint Documentation" data-md-component="logo">
      
  
  <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 15.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="260.479px" height="365.463px" viewBox="0 0 260.479 365.463" enable-background="new 0 0 260.479 365.463"
	 xml:space="preserve">
<g>
	<path d="M4.638,361.434c0,0,124.071-124.072,135.896-357.434c0,0,29.555,189.053,115.266,256.988
		C255.799,260.988,173.038,249.174,4.638,361.434z"/>
</g>
</svg>

    </a>
    DataJoint Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datajoint/datajoint-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    datajoint/datajoint-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../explanation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/data-pipelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/whats-new-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    What's New in 2.0
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Model
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Model
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/relational-workflow-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Relational Workflow Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/entity-integrity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entity Integrity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/normalization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Normalization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/computation-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Computation Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Queries
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Queries
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/query-algebra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Algebra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/semantic-matching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Matching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Storage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/type-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Type System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/custom-codecs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Codecs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Basics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Basics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basics/01-first-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A Simple Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basics/02-schema-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schema Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basics/03-data-entry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Entry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basics/04-queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Queries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basics/05-computation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Computation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basics/06-object-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object-Augmented Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/examples/university/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    University Database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/examples/hotel-reservations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hotel Reservation System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/examples/languages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Languages and Proficiency
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/examples/fractal-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fractal Image Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/examples/blob-detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blob Detection Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Domain
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Domain
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/domain/calcium-imaging/calcium-imaging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calcium Imaging Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/domain/electrophysiology/electrophysiology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Electrophysiology Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/domain/electrophysiology/ephys-with-npy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Electrophysiology Pipeline with Object Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/domain/allen-ccf/allen-ccf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Allen Common Coordinate Framework (CCF)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced/sql-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DataJoint for SQL Users
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced/json-type/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JSON Data Type
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced/distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Computing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced/custom-codecs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Codecs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    How-To
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-To
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setup
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configure Database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configure Object Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../use-cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Command-Line Interface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Schema Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Schema Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../define-tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Define Tables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model-relationships/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Relationships
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design-primary-keys/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Primary Keys
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../read-diagrams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Read Schema Diagrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Project Management
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Project Management
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manage-pipeline-project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manage Pipeline Project
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Operations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Operations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../insert-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Insert Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../query-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fetch-results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fetch Results
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../delete-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Delete Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Computation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Computation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../run-computations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run Computations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distributed-computing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Computing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handle-errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Handle Errors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitor-progress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitor Progress
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Object Storage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Object Storage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../use-object-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use Object Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../use-npy-codec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use NPY Codec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../use-plugin-codecs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use Plugin Codecs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-custom-codec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create Custom Codecs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manage-large-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manage Large Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../garbage-collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clean Up Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" checked>
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Maintenance
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Maintenance
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Migrate to 2.0
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Migrate to 2.0
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#license-change" class="md-nav__link">
    <span class="md-ellipsis">
      
        License Change
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-backend-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Backend Support
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before-you-start-testing-recommendation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Before You Start: Testing Recommendation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-new-in-20" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's New in 2.0
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What&#39;s New in 2.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-tier-column-type-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        3-Tier Column Type System
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Codecs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Codecs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#migration-legacy-20" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration: Legacy â†’ 2.0
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-in-20-schema-addressed-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        New in 2.0: Schema-Addressed Storage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-stores-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unified Stores Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-api-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Query API Changes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendation-create-tests-before-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendation: Create Tests Before Migration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendation: Create Tests Before Migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-tests-enable-automated-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Tests Enable Automated Migration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-tests-to-create" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Tests to Create
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-tests-with-ai-agents" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to Use Tests with AI Agents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#investment-vs-return" class="md-nav__link">
    <span class="md-ellipsis">
      
        Investment vs. Return
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-skip-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        When to Skip Tests
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-i-branch-and-code-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase I: Branch and Code Migration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase I: Branch and Code Migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-pin-legacy-datajoint-on-main-branch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Pin Legacy DataJoint on Main Branch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-migration-branch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Create Migration Branch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-update-schema-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Update Schema Declarations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Update Schema Declarations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#find-all-schema-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find All Schema Declarations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-schema-names" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update Schema Names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-update-schema-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Update Schema Declarations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-schema-name-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verify Schema Name Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commit-schema-declaration-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Commit Schema Declaration Changes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-datajoint-20" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Configure DataJoint 2.0
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Configure DataJoint 2.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-configuration-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: Configuration Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Configuration Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-connection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verify Connection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-configure-test-object-stores-if-applicable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Configure Test Object Stores (If Applicable)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Configure Test Object Stores (If Applicable)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-pre-20-implicit-vs-20-explicit-codecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: pre-2.0 Implicit vs 2.0 Explicit Codecs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#background-unified-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: Unified Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-test-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure Test Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-configure-and-test-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Configure and Test Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-in-store-codecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test In-Store Codecs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-convert-table-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6: Convert Table Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 6: Convert Table Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-type-syntax-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: Type Syntax Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-convert-table-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Convert Table Definitions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-convert-query-and-insert-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7: Convert Query and Insert Code
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 7: Convert Query and Insert Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-api-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: API Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-convert-query-and-insert-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Convert Query and Insert Code
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-update-populate-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 8: Update Populate Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-verify-phase-i-complete" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 9: Verify Phase I Complete
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 9: Verify Phase I Complete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-schema-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Schema Creation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commit-phase-i" class="md-nav__link">
    <span class="md-ellipsis">
      
        Commit Phase I
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-ii-test-compatibility-and-equivalence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase II: Test Compatibility and Equivalence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase II: Test Compatibility and Equivalence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-run-your-regular-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Run Your Regular Workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-compare-with-legacy-schema-equivalence-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Compare with Legacy Schema (Equivalence Testing)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Compare with Legacy Schema (Equivalence Testing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-a-side-by-side-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option A: Side-by-Side Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-b-data-copy-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option B: Data Copy and Validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-run-existing-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Run Existing Tests
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-document-test-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Document Test Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-iii-migrate-production-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase III: Migrate Production Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase III: Migrate Production Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-a-copy-data-and-rename-schemas-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option A: Copy Data and Rename Schemas (Recommended)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Option A: Copy Data and Rename Schemas (Recommended)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0-configure-production-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        0. Configure Production Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-backup-production" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Backup Production
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-copy-manual-table-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Copy Manual Table Data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-populate-computed-tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Populate Computed Tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-migrate-in-store-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Migrate In-Store Metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-validate-data-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Validate Data Integrity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-schedule-cutover" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Schedule Cutover
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-verify-production" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Verify Production
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-cleanup-after-1-2-weeks" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Cleanup (After 1-2 Weeks)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-b-in-place-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option B: In-Place Migration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-c-gradual-migration-with-legacy-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option C: Gradual Migration with Legacy Compatibility
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Option C: Gradual Migration with Legacy Compatibility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-_v2-columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Add _v2 Columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-populate-_v2-columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Populate _v2 Columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-update-code-to-use-_v2-columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Update Code to Use _v2 Columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-final-cutover" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Final Cutover
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-iv-adopt-new-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase IV: Adopt New Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase IV: Adopt New Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#new-features-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Features Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-path" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learning Path
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Import Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema-not-found" class="md-nav__link">
    <span class="md-ellipsis">
      
        Schema Not Found
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-syntax-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Type Syntax Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-storage-not-found" class="md-nav__link">
    <span class="md-ellipsis">
      
        External Storage Not Found
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alter-tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alter Tables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backup-restore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup and Restore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/specs/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Specifications
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Specifications
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Schema Definition
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Schema Definition
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/table-declaration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Table Declaration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/master-part/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Master-Part
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/virtual-schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Virtual Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Query Algebra
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Query Algebra
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/query-algebra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/semantic-matching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Matching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/primary-keys/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Primary Keys
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/fetch-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fetch API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Type System
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Type System
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/type-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/codec-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Codec API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/npy-codec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NPY Codec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Operations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Operations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/data-manipulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Manipulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/autopopulate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AutoPopulate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/job-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Job Metadata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/specs/object-store-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object Store Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/definition-syntax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Definition Syntax
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Errors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Elements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api/datajoint/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Datajoint
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Datajoint
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/admin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Admin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/blob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blob
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/codecs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Codecs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/connection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/diagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diagram
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Errors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/expression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Expressions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/hash_registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hash Registry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/heading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Heading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jobs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/migrate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migrate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schema
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/table/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Table
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datajoint/user_tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Table Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../about/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/versioning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation Versioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.datajoint.com/sign-up" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/citation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Citation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Publications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#license-change" class="md-nav__link">
    <span class="md-ellipsis">
      
        License Change
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-backend-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Backend Support
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before-you-start-testing-recommendation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Before You Start: Testing Recommendation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-new-in-20" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's New in 2.0
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What&#39;s New in 2.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-tier-column-type-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        3-Tier Column Type System
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Codecs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Codecs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#migration-legacy-20" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration: Legacy â†’ 2.0
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-in-20-schema-addressed-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        New in 2.0: Schema-Addressed Storage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-stores-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unified Stores Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-api-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Query API Changes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendation-create-tests-before-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendation: Create Tests Before Migration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendation: Create Tests Before Migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-tests-enable-automated-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Tests Enable Automated Migration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-tests-to-create" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Tests to Create
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-tests-with-ai-agents" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to Use Tests with AI Agents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#investment-vs-return" class="md-nav__link">
    <span class="md-ellipsis">
      
        Investment vs. Return
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-skip-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        When to Skip Tests
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-i-branch-and-code-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase I: Branch and Code Migration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase I: Branch and Code Migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-pin-legacy-datajoint-on-main-branch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Pin Legacy DataJoint on Main Branch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-migration-branch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Create Migration Branch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-update-schema-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Update Schema Declarations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Update Schema Declarations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#find-all-schema-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find All Schema Declarations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-schema-names" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update Schema Names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-update-schema-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Update Schema Declarations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-schema-name-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verify Schema Name Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commit-schema-declaration-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Commit Schema Declaration Changes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-datajoint-20" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Configure DataJoint 2.0
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Configure DataJoint 2.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-configuration-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: Configuration Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Configuration Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-connection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verify Connection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-configure-test-object-stores-if-applicable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Configure Test Object Stores (If Applicable)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Configure Test Object Stores (If Applicable)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-pre-20-implicit-vs-20-explicit-codecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: pre-2.0 Implicit vs 2.0 Explicit Codecs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#background-unified-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: Unified Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-test-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure Test Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-configure-and-test-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Configure and Test Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-in-store-codecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test In-Store Codecs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-convert-table-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6: Convert Table Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 6: Convert Table Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-type-syntax-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: Type Syntax Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-convert-table-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Convert Table Definitions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-convert-query-and-insert-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7: Convert Query and Insert Code
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 7: Convert Query and Insert Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background-api-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background: API Changes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-agent-prompt-convert-query-and-insert-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Agent Prompt: Convert Query and Insert Code
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-update-populate-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 8: Update Populate Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-verify-phase-i-complete" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 9: Verify Phase I Complete
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 9: Verify Phase I Complete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-schema-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Schema Creation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commit-phase-i" class="md-nav__link">
    <span class="md-ellipsis">
      
        Commit Phase I
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-ii-test-compatibility-and-equivalence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase II: Test Compatibility and Equivalence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase II: Test Compatibility and Equivalence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-run-your-regular-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Run Your Regular Workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-compare-with-legacy-schema-equivalence-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Compare with Legacy Schema (Equivalence Testing)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Compare with Legacy Schema (Equivalence Testing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-a-side-by-side-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option A: Side-by-Side Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-b-data-copy-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option B: Data Copy and Validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-run-existing-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Run Existing Tests
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-document-test-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Document Test Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-iii-migrate-production-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase III: Migrate Production Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase III: Migrate Production Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-a-copy-data-and-rename-schemas-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option A: Copy Data and Rename Schemas (Recommended)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Option A: Copy Data and Rename Schemas (Recommended)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0-configure-production-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        0. Configure Production Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-backup-production" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Backup Production
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-copy-manual-table-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Copy Manual Table Data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-populate-computed-tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Populate Computed Tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-migrate-in-store-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Migrate In-Store Metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-validate-data-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Validate Data Integrity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-schedule-cutover" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Schedule Cutover
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-verify-production" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Verify Production
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-cleanup-after-1-2-weeks" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Cleanup (After 1-2 Weeks)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-b-in-place-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option B: In-Place Migration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-c-gradual-migration-with-legacy-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      
        Option C: Gradual Migration with Legacy Compatibility
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Option C: Gradual Migration with Legacy Compatibility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-_v2-columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Add _v2 Columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-populate-_v2-columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Populate _v2 Columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-update-code-to-use-_v2-columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Update Code to Use _v2 Columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-final-cutover" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Final Cutover
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-iv-adopt-new-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase IV: Adopt New Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase IV: Adopt New Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#new-features-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Features Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-path" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learning Path
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Import Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema-not-found" class="md-nav__link">
    <span class="md-ellipsis">
      
        Schema Not Found
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-syntax-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Type Syntax Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-storage-not-found" class="md-nav__link">
    <span class="md-ellipsis">
      
        External Storage Not Found
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="migrate-to-datajoint-20">Migrate to DataJoint 2.0<a class="headerlink" href="#migrate-to-datajoint-20" title="Permanent link">&para;</a></h1>
<p>Upgrade existing pipelines from legacy DataJoint (pre-2.0) to DataJoint 2.0.</p>
<blockquote>
<p><strong>This guide is optimized for AI coding assistants.</strong> Point your AI agent at this
document and it will execute the migration with your oversight.</p>
</blockquote>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<h3 id="system-requirements">System Requirements<a class="headerlink" href="#system-requirements" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Legacy (pre-2.0)</th>
<th>DataJoint 2.0</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Python</strong></td>
<td>3.8+</td>
<td><strong>3.10+</strong></td>
</tr>
<tr>
<td><strong>MySQL</strong></td>
<td>5.7+</td>
<td><strong>8.0+</strong></td>
</tr>
<tr>
<td><strong>Character encoding</strong></td>
<td>(varies)</td>
<td><strong>UTF-8 (utf8mb4)</strong></td>
</tr>
<tr>
<td><strong>Collation</strong></td>
<td>(varies)</td>
<td><strong>utf8mb4_bin</strong></td>
</tr>
</tbody>
</table>
<p><strong>Action required:</strong> Upgrade your Python environment and MySQL server before installing DataJoint 2.0.</p>
<p><strong>Character encoding and collation:</strong> DataJoint 2.0 standardizes on UTF-8 encoding with binary collation (case-sensitive comparisons). This is configured <strong>server-wide</strong> and is assumed by DataJoint:</p>
<ul>
<li><strong>MySQL:</strong> <code>utf8mb4</code> character set with <code>utf8mb4_bin</code> collation</li>
<li><strong>PostgreSQL (future):</strong> <code>UTF8</code> encoding with <code>C</code> collation</li>
</ul>
<p>Like timezone handling, encoding is infrastructure configuration, not part of the data model. Ensure your MySQL server is configured with these defaults before migration.</p>
<h3 id="license-change">License Change<a class="headerlink" href="#license-change" title="Permanent link">&para;</a></h3>
<p>DataJoint 2.0 is licensed under <strong>Apache 2.0</strong> (previously LGPL-2.1).</p>
<ul>
<li>More permissive for commercial and academic use</li>
<li>Compatible with broader ecosystem of tools</li>
<li>Clearer patent grant provisions</li>
</ul>
<p>No action requiredâ€”the new license is more permissive.</p>
<h3 id="future-backend-support">Future Backend Support<a class="headerlink" href="#future-backend-support" title="Permanent link">&para;</a></h3>
<p>DataJoint 2.0 introduces portable type aliases (<code>int64</code>, <code>float64</code>, etc.) that prepare the codebase for <strong>PostgreSQL backend compatibility</strong> in a future release. Migration to core types ensures your schemas will work seamlessly when Postgres support is available.</p>
<h3 id="before-you-start-testing-recommendation">Before You Start: Testing Recommendation<a class="headerlink" href="#before-you-start-testing-recommendation" title="Permanent link">&para;</a></h3>
<p><strong>âš¡ Want AI agents to automate Phases I-II for you?</strong></p>
<p>Create unit and integration tests for your pipeline against a QA database before
starting migration. This enables AI agents to perform most migration work
automatically, reducing manual effort by 50-80%.</p>
<p>â†’ <strong>See <a href="#recommendation-create-tests-before-migration">Recommendation: Create Tests Before Migration</a></strong> for details.</p>
<p><strong>Why this matters:</strong></p>
<ul>
<li><strong>With tests:</strong> Agents migrate code â†’ run tests â†’ fix failures â†’ verify automatically</li>
<li><strong>Without tests:</strong> Manual verification at every step, higher risk, more time</li>
</ul>
<p>Tests provide immediate ROI during migration and ongoing value for development.</p>
<hr />
<h2 id="whats-new-in-20">What's New in 2.0<a class="headerlink" href="#whats-new-in-20" title="Permanent link">&para;</a></h2>
<h3 id="3-tier-column-type-system">3-Tier Column Type System<a class="headerlink" href="#3-tier-column-type-system" title="Permanent link">&para;</a></h3>
<p>DataJoint 2.0 introduces a unified type system with three tiers:</p>
<table>
<thead>
<tr>
<th>Tier</th>
<th>Description</th>
<th>Examples</th>
<th>Migration</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Native</strong></td>
<td>Raw MySQL types</td>
<td><code>int unsigned</code>, <code>tinyint</code></td>
<td>Auto-converted to core types</td>
</tr>
<tr>
<td><strong>Core</strong></td>
<td>Standardized portable types</td>
<td><code>int64</code>, <code>float64</code>, <code>varchar(100)</code>, <code>json</code></td>
<td>Phase I</td>
</tr>
<tr>
<td><strong>Codec</strong></td>
<td>Serialization to blob or storage</td>
<td><code>&lt;blob&gt;</code>, <code>&lt;blob@store&gt;</code>, <code>&lt;npy@&gt;</code></td>
<td>Phase I-III</td>
</tr>
</tbody>
</table>
<p><strong>Learn more:</strong> <a href="../../explanation/type-system/">Type System Concept</a> Â· <a href="../../reference/specs/type-system/">Type System Reference</a></p>
<h3 id="codecs">Codecs<a class="headerlink" href="#codecs" title="Permanent link">&para;</a></h3>
<p>DataJoint 2.0 makes serialization <strong>explicit</strong> with codecs. In pre-2.0, <code>longblob</code> automatically serialized Python objects; in 2.0, you explicitly choose <code>&lt;blob&gt;</code>.</p>
<h4 id="migration-legacy-20">Migration: Legacy â†’ 2.0<a class="headerlink" href="#migration-legacy-20" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>pre-2.0 (Implicit)</th>
<th>2.0 (Explicit)</th>
<th>Storage</th>
<th>Migration</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>longblob</code></td>
<td><code>&lt;blob&gt;</code></td>
<td>In-table</td>
<td>Phase I code, Phase III data</td>
</tr>
<tr>
<td><code>mediumblob</code></td>
<td><code>&lt;blob&gt;</code></td>
<td>In-table</td>
<td>Phase I code, Phase III data</td>
</tr>
<tr>
<td><code>attach</code></td>
<td><code>&lt;attach&gt;</code></td>
<td>In-table</td>
<td>Phase I code, Phase III data</td>
</tr>
<tr>
<td><code>blob@store</code></td>
<td><code>&lt;blob@store&gt;</code></td>
<td>In-store (hash)</td>
<td>Phase I code, Phase III data</td>
</tr>
<tr>
<td><code>attach@store</code></td>
<td><code>&lt;attach@store&gt;</code></td>
<td>In-store (hash)</td>
<td>Phase I code, Phase III data</td>
</tr>
<tr>
<td><code>filepath@store</code></td>
<td><code>&lt;filepath@store&gt;</code></td>
<td>In-store (filepath)</td>
<td>Phase I code, Phase III data</td>
</tr>
</tbody>
</table>
<h4 id="new-in-20-schema-addressed-storage">New in 2.0: Schema-Addressed Storage<a class="headerlink" href="#new-in-20-schema-addressed-storage" title="Permanent link">&para;</a></h4>
<p>These codecs are NEWâ€”there's no legacy equivalent to migrate:</p>
<table>
<thead>
<tr>
<th>Codec</th>
<th>Description</th>
<th>Storage</th>
<th>Adoption</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;npy@store&gt;</code></td>
<td>NumPy arrays with lazy loading</td>
<td>In-store (schema)</td>
<td>Phase IV (optional)</td>
</tr>
<tr>
<td><code>&lt;object@store&gt;</code></td>
<td>Zarr, HDF5, custom formats</td>
<td>In-store (schema)</td>
<td>Phase IV (optional)</td>
</tr>
</tbody>
</table>
<p><strong>Key principles:</strong></p>
<ul>
<li>All <strong>legacy codec</strong> conversions happen in Phase I (code) and Phase III (data)</li>
<li><strong>New codecs</strong> (<code>&lt;npy@&gt;</code>, <code>&lt;object@&gt;</code>) are adopted in Phase IV for new features or enhanced workflows</li>
<li>Schema-addressed storage organizes data by table structureâ€”no migration needed, just new functionality</li>
</ul>
<p><strong>Learn more:</strong> <a href="../../reference/specs/codec-api/">Codec API Reference</a> Â· <a href="../../explanation/custom-codecs/">Custom Codecs</a></p>
<h3 id="unified-stores-configuration">Unified Stores Configuration<a class="headerlink" href="#unified-stores-configuration" title="Permanent link">&para;</a></h3>
<p>DataJoint 2.0 replaces <code>external.*</code> with unified <code>stores.*</code> configuration:</p>
<p><strong>pre-2.0 (legacy):</strong>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;external&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/external&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>2.0 (unified stores):</strong>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stores&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/stores&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Learn more:</strong> <a href="../../reference/configuration/">Configuration Reference</a> Â· <a href="../configure-storage/">Configure Object Storage</a></p>
<h3 id="query-api-changes">Query API Changes<a class="headerlink" href="#query-api-changes" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>pre-2.0</th>
<th>2.0</th>
<th>Phase</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table.fetch()</code></td>
<td><code>table.to_arrays()</code> or <code>table.to_dicts()</code></td>
<td>I</td>
</tr>
<tr>
<td><code>table.fetch(..., format="frame")</code></td>
<td><code>table.to_pandas(...)</code></td>
<td>I</td>
</tr>
<tr>
<td><code>table.fetch1()</code></td>
<td><code>table.fetch1()</code> (unchanged)</td>
<td>â€”</td>
</tr>
<tr>
<td><code>table.fetch1('KEY')</code></td>
<td><code>table.keys()</code></td>
<td>I</td>
</tr>
<tr>
<td><code>(table &amp; key)._update('attr', val)</code></td>
<td><code>table.update1({**key, 'attr': val})</code></td>
<td>I</td>
</tr>
<tr>
<td><code>table1 @ table2</code></td>
<td><code>table1 * table2</code> (natural join with semantic checks)</td>
<td>I</td>
</tr>
<tr>
<td><code>a.join(b, left=True)</code></td>
<td>Consider <code>a.extend(b)</code></td>
<td>I</td>
</tr>
<tr>
<td><code>dj.U('attr') &amp; table</code></td>
<td>Unchanged (correct pattern)</td>
<td>â€”</td>
</tr>
<tr>
<td><code>dj.U('attr') * table</code></td>
<td><code>table</code> (was a hack to change primary key)</td>
<td>I</td>
</tr>
<tr>
<td><code>dj.ERD(schema)</code></td>
<td><code>dj.Diagram(schema)</code></td>
<td>I</td>
</tr>
<tr>
<td><code>table.insert([(1, 'a'), (2, 'b')])</code></td>
<td>Must use dicts/DataFrames (no positional tuples)</td>
<td>I</td>
</tr>
</tbody>
</table>
<p><strong>Learn more:</strong> <a href="../../reference/specs/fetch-api/">Fetch API Reference</a> Â· <a href="../../reference/operators/">Query Operators Reference</a> Â· <a href="../../reference/specs/semantic-matching/">Semantic Matching</a></p>
<hr />
<h2 id="migration-overview">Migration Overview<a class="headerlink" href="#migration-overview" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Phase</th>
<th>Goal</th>
<th>Code Changes</th>
<th>Schema/Store Changes</th>
<th>Production Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>I</strong></td>
<td>Branch &amp; code migration</td>
<td>All API updates, type syntax, <strong>all codecs</strong> (in-table and in-store)</td>
<td>Empty <code>_v2</code> schemas + test stores</td>
<td><strong>None</strong></td>
</tr>
<tr>
<td><strong>II</strong></td>
<td>Test compatibility</td>
<td>â€”</td>
<td>Populate <code>_v2</code> schemas with sample data, test equivalence</td>
<td><strong>None</strong></td>
</tr>
<tr>
<td><strong>III</strong></td>
<td>Migrate production data</td>
<td>â€”</td>
<td>Multiple migration options</td>
<td><strong>Varies</strong></td>
</tr>
<tr>
<td><strong>IV</strong></td>
<td>Adopt new features</td>
<td>Optional enhancements</td>
<td>Optional</td>
<td>Running on 2.0</td>
</tr>
</tbody>
</table>
<p><strong>Key principles:</strong></p>
<ul>
<li>Phase I implements ALL code changes including in-store codecs (using test stores)</li>
<li>Production runs on pre-2.0 undisturbed through Phase II</li>
<li>Phase III is data migration onlyâ€”the code is already complete</li>
</ul>
<p><strong>Timeline:</strong></p>
<ul>
<li><strong>Phase I:</strong> ~1-4 hours (with AI assistance)</li>
<li><strong>Phase II:</strong> ~1-2 days</li>
<li><strong>Phase III:</strong> ~1-7 days (depends on data size and option chosen)</li>
<li><strong>Phase IV:</strong> Ongoing feature adoption</li>
</ul>
<hr />
<h2 id="recommendation-create-tests-before-migration">Recommendation: Create Tests Before Migration<a class="headerlink" href="#recommendation-create-tests-before-migration" title="Permanent link">&para;</a></h2>
<p><strong>Highly recommended for automated, agent-driven migration.</strong></p>
<p>If you create unit and integration tests for your pipeline before starting
Phase I, AI coding agents can perform most of the migration work automatically,
substantially reducing manual effort.</p>
<h3 id="why-tests-enable-automated-migration">Why Tests Enable Automated Migration<a class="headerlink" href="#why-tests-enable-automated-migration" title="Permanent link">&para;</a></h3>
<p><strong>With tests:</strong></p>
<ol>
<li>
<p><strong>Phase I automation</strong> - Agent can:</p>
<ul>
<li>Migrate code to 2.0 API</li>
<li>Run tests to verify correctness</li>
<li>Fix failures iteratively</li>
<li>Complete migration with high confidence</li>
</ul>
</li>
<li>
<p><strong>Phase II automation</strong> - Agent can:</p>
<ul>
<li>Populate <code>_v2</code> schemas with test data</li>
<li>Run tests against both legacy and v2 pipelines</li>
<li>Verify equivalence automatically</li>
<li>Generate validation reports</li>
</ul>
</li>
<li>
<p><strong>Phase III guidance</strong> - Agent can:</p>
<ul>
<li>Run tests after data migration</li>
<li>Catch issues immediately</li>
<li>Guide production cutover with confidence</li>
</ul>
</li>
</ol>
<p><strong>Without tests:</strong></p>
<ul>
<li>Manual verification at each step</li>
<li>Higher risk of missed issues</li>
<li>More time-intensive validation</li>
<li>Uncertainty about correctness</li>
</ul>
<h3 id="what-tests-to-create">What Tests to Create<a class="headerlink" href="#what-tests-to-create" title="Permanent link">&para;</a></h3>
<p>Create tests against a <strong>QA database and object store</strong> (separate from
production):</p>
<p><strong>Unit tests:</strong></p>
<ul>
<li>Table definitions compile correctly</li>
<li>Schema relationships are valid</li>
<li>Populate methods work for individual tables</li>
<li>Query patterns return expected results</li>
</ul>
<p><strong>Integration tests:</strong></p>
<ul>
<li>End-to-end pipeline execution</li>
<li>Data flows through computed tables correctly</li>
<li>External file references work (if using <code>&lt;filepath@&gt;</code>)</li>
<li>Object storage operations work (if using in-store codecs)</li>
</ul>
<p><strong>Example test structure:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># tests/test_tables.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dj</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">my_pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mouse</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">Neuron</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_schema</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use QA database for testing.&quot;&quot;&quot;</span>
    <span class="n">dj</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;database.host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;qa-db.example.com&#39;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;test_pipeline&#39;</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">schema</span>
    <span class="n">schema</span><span class="o">.</span><span class="n">drop</span><span class="p">()</span>  <span class="c1"># Cleanup after test</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_mouse_insert</span><span class="p">(</span><span class="n">test_schema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test manual table insertion.&quot;&quot;&quot;</span>
    <span class="n">Mouse</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">})</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mouse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_session_populate</span><span class="p">(</span><span class="n">test_schema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test session insertion and relationships.&quot;&quot;&quot;</span>
    <span class="n">Mouse</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">})</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span>
        <span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;session_date&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-06-01&#39;</span><span class="p">,</span>
        <span class="s1">&#39;experimenter&#39;</span><span class="p">:</span> <span class="s1">&#39;Alice&#39;</span>
    <span class="p">})</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Session</span><span class="p">()</span> <span class="o">&amp;</span> <span class="s1">&#39;mouse_id=0&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_neuron_computation</span><span class="p">(</span><span class="n">test_schema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test computed table populate.&quot;&quot;&quot;</span>
    <span class="c1"># Insert upstream data</span>
    <span class="n">Mouse</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">})</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span>
        <span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;session_date&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-06-01&#39;</span><span class="p">,</span>
        <span class="s1">&#39;experimenter&#39;</span><span class="p">:</span> <span class="s1">&#39;Alice&#39;</span>
    <span class="p">})</span>

    <span class="c1"># Populate computed table</span>
    <span class="n">Neuron</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>

    <span class="c1"># Verify results</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Neuron</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_query_patterns</span><span class="p">(</span><span class="n">test_schema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test common query patterns.&quot;&quot;&quot;</span>
    <span class="c1"># Setup data</span>
    <span class="n">Mouse</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">})</span>

    <span class="c1"># Test fetch</span>
    <span class="n">mice</span> <span class="o">=</span> <span class="n">Mouse</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="c1"># Test restriction</span>
    <span class="n">male_mice</span> <span class="o">=</span> <span class="n">Mouse</span> <span class="o">&amp;</span> <span class="s1">&#39;sex=&quot;M&quot;&#39;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">male_mice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</code></pre></div>
<p><strong>Integration test example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># tests/test_pipeline.py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_full_pipeline</span><span class="p">(</span><span class="n">test_schema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test complete pipeline execution.&quot;&quot;&quot;</span>
    <span class="c1"># 1. Insert manual data</span>
    <span class="n">Mouse</span><span class="o">.</span><span class="n">insert</span><span class="p">([</span>
        <span class="p">{</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;F&#39;</span><span class="p">},</span>
    <span class="p">])</span>

    <span class="n">Session</span><span class="o">.</span><span class="n">insert</span><span class="p">([</span>
        <span class="p">{</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;session_date&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-06-01&#39;</span><span class="p">,</span> <span class="s1">&#39;experimenter&#39;</span><span class="p">:</span> <span class="s1">&#39;Alice&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;session_date&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-06-03&#39;</span><span class="p">,</span> <span class="s1">&#39;experimenter&#39;</span><span class="p">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">},</span>
    <span class="p">])</span>

    <span class="c1"># 2. Populate computed tables</span>
    <span class="n">Neuron</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
    <span class="n">Analysis</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>

    <span class="c1"># 3. Verify data flows correctly</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mouse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Session</span><span class="p">())</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Neuron</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Analysis</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="c1"># 4. Test queries work</span>
    <span class="n">alice_sessions</span> <span class="o">=</span> <span class="n">Session</span> <span class="o">&amp;</span> <span class="s1">&#39;experimenter=&quot;Alice&quot;&#39;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">alice_sessions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</code></pre></div>
<h3 id="how-to-use-tests-with-ai-agents">How to Use Tests with AI Agents<a class="headerlink" href="#how-to-use-tests-with-ai-agents" title="Permanent link">&para;</a></h3>
<p>Once tests are created, an AI agent can:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Agent workflow for Phase I</span>
<span class="m">1</span>.<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>pre/v2.0
<span class="m">2</span>.<span class="w"> </span>Update<span class="w"> </span>schema<span class="w"> </span>declarations<span class="w"> </span>to<span class="w"> </span>_v2
<span class="m">3</span>.<span class="w"> </span>Convert<span class="w"> </span>table<span class="w"> </span>definitions<span class="w"> </span>to<span class="w"> </span><span class="m">2</span>.0<span class="w"> </span>syntax
<span class="m">4</span>.<span class="w"> </span>Convert<span class="w"> </span>API<span class="w"> </span>calls<span class="w"> </span><span class="o">(</span>fetch<span class="w"> </span>â†’<span class="w"> </span>to_dicts,<span class="w"> </span>etc.<span class="o">)</span>
<span class="m">5</span>.<span class="w"> </span>Run:<span class="w"> </span>pytest<span class="w"> </span>tests/
<span class="m">6</span>.<span class="w"> </span>Fix<span class="w"> </span>any<span class="w"> </span>failures<span class="w"> </span>iteratively
<span class="m">7</span>.<span class="w"> </span>Repeat<span class="w"> </span><span class="m">5</span>-6<span class="w"> </span><span class="k">until</span><span class="w"> </span>all<span class="w"> </span>tests<span class="w"> </span>pass
<span class="m">8</span>.<span class="w"> </span>Phase<span class="w"> </span>I<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>automatically!

<span class="c1"># Agent workflow for Phase II</span>
<span class="m">1</span>.<span class="w"> </span>Populate<span class="w"> </span>_v2<span class="w"> </span>schemas<span class="w"> </span>with<span class="w"> </span><span class="nb">test</span><span class="w"> </span>data
<span class="m">2</span>.<span class="w"> </span>Run<span class="w"> </span>tests<span class="w"> </span>against<span class="w"> </span>_v2<span class="w"> </span>schemas
<span class="m">3</span>.<span class="w"> </span>Compare<span class="w"> </span>with<span class="w"> </span>legacy<span class="w"> </span>results
<span class="m">4</span>.<span class="w"> </span>Generate<span class="w"> </span>validation<span class="w"> </span>report
<span class="m">5</span>.<span class="w"> </span>Phase<span class="w"> </span>II<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>automatically!
</code></pre></div>
<h3 id="investment-vs-return">Investment vs. Return<a class="headerlink" href="#investment-vs-return" title="Permanent link">&para;</a></h3>
<p><strong>Time investment:</strong></p>
<ul>
<li>Creating tests: ~1-3 days</li>
<li>QA database setup: ~1-2 hours</li>
</ul>
<p><strong>Time saved:</strong></p>
<ul>
<li>Phase I: ~50-75% reduction (mostly automated)</li>
<li>Phase II: ~80% reduction (fully automated validation)</li>
<li>Phase III: Higher confidence, faster debugging</li>
</ul>
<p><strong>Net benefit:</strong> Tests pay for themselves during migration and provide ongoing
value for future development.</p>
<h3 id="when-to-skip-tests">When to Skip Tests<a class="headerlink" href="#when-to-skip-tests" title="Permanent link">&para;</a></h3>
<p>Skip test creation if:</p>
<ul>
<li>Pipeline is very simple (few tables, no computation)</li>
<li>One-time migration with no ongoing development</li>
<li>Team has extensive manual testing procedures already</li>
<li>Time pressure requires starting migration immediately</li>
</ul>
<p><strong>Note:</strong> Even minimal tests (just table insertion and populate) provide
significant value for automated migration.</p>
<hr />
<h2 id="phase-i-branch-and-code-migration">Phase I: Branch and Code Migration<a class="headerlink" href="#phase-i-branch-and-code-migration" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Implement complete 2.0 API in code using test schemas and test stores.</p>
<p><strong>End state:</strong></p>
<ul>
<li>All Python code uses 2.0 API patterns (fetch, types, codecs)</li>
<li>All codecs implemented (in-table <code>&lt;blob&gt;</code>, <code>&lt;attach&gt;</code> AND in-store <code>&lt;blob@&gt;</code>, legacy only)</li>
<li>Code points to <code>schema_v2</code> databases (empty) and test object stores</li>
<li>Production continues on main branch with pre-2.0 undisturbed</li>
</ul>
<p><strong>What's NOT migrated yet:</strong> Production data and production stores (Phase III)</p>
<h3 id="step-1-pin-legacy-datajoint-on-main-branch">Step 1: Pin Legacy DataJoint on Main Branch<a class="headerlink" href="#step-1-pin-legacy-datajoint-on-main-branch" title="Permanent link">&para;</a></h3>
<p>Ensure production code stays on pre-2.0:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>checkout<span class="w"> </span>main

<span class="c1"># Pin legacy version in requirements</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;datajoint&lt;2.0.0&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>requirements.txt

git<span class="w"> </span>add<span class="w"> </span>requirements.txt
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;chore: pin legacy datajoint for production&quot;</span>
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>main
</code></pre></div>
<p><strong>Why:</strong> This prevents accidental upgrades to 2.0 in production.</p>
<h3 id="step-2-create-migration-branch">Step 2: Create Migration Branch<a class="headerlink" href="#step-2-create-migration-branch" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Create feature branch</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>pre/v2.0

<span class="c1"># Install DataJoint 2.0</span>
pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;datajoint&gt;=2.0.0&quot;</span>

<span class="c1"># Update requirements</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;datajoint&gt;=2.0.0&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>requirements.txt

git<span class="w"> </span>add<span class="w"> </span>requirements.txt
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;chore: upgrade to datajoint 2.0&quot;</span>
</code></pre></div>
<h3 id="step-3-update-schema-declarations">Step 3: Update Schema Declarations<a class="headerlink" href="#step-3-update-schema-declarations" title="Permanent link">&para;</a></h3>
<p><strong>Critical early step:</strong> Update all <code>dj.schema()</code> calls to use <code>_v2</code> suffix
for parallel testing and validation.</p>
<p><strong>Why do this first:</strong></p>
<ul>
<li>Creates parallel schemas alongside production (e.g., <code>my_pipeline_v2</code>)</li>
<li>Allows testing 2.0 code without affecting production schemas</li>
<li>Enables side-by-side validation in Phase II</li>
<li>Production schemas remain untouched on <code>main</code> branch</li>
</ul>
<h4 id="find-all-schema-declarations">Find All Schema Declarations<a class="headerlink" href="#find-all-schema-declarations" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Find all schema() calls in your codebase</span>
grep<span class="w"> </span>-rn<span class="w"> </span><span class="s2">&quot;dj.schema\|dj.Schema&quot;</span><span class="w"> </span>--include<span class="o">=</span><span class="s2">&quot;*.py&quot;</span><span class="w"> </span>.

<span class="c1"># Example output:</span>
<span class="c1"># pipeline/session.py:5:schema = dj.schema(&#39;my_pipeline&#39;)</span>
<span class="c1"># pipeline/analysis.py:8:schema = dj.schema(&#39;my_pipeline&#39;)</span>
<span class="c1"># pipeline/ephys.py:3:schema = dj.schema(&#39;ephys_pipeline&#39;)</span>
</code></pre></div>
<h4 id="update-schema-names">Update Schema Names<a class="headerlink" href="#update-schema-names" title="Permanent link">&para;</a></h4>
<p><strong>For each schema declaration, add <code>_v2</code> suffix:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># BEFORE (production, on main branch)</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;my_pipeline&#39;</span><span class="p">)</span>

<span class="c1"># AFTER (testing, on pre/v2.0 branch)</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;my_pipeline_v2&#39;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Multiple schemas example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># BEFORE</span>
<span class="n">session_schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;sessions&#39;</span><span class="p">)</span>
<span class="n">analysis_schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>
<span class="n">ephys_schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;ephys&#39;</span><span class="p">)</span>

<span class="c1"># AFTER</span>
<span class="n">session_schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;sessions_v2&#39;</span><span class="p">)</span>
<span class="n">analysis_schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;analysis_v2&#39;</span><span class="p">)</span>
<span class="n">ephys_schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;ephys_v2&#39;</span><span class="p">)</span>
</code></pre></div>
<h4 id="ai-agent-prompt-update-schema-declarations">AI Agent Prompt: Update Schema Declarations<a class="headerlink" href="#ai-agent-prompt-update-schema-declarations" title="Permanent link">&para;</a></h4>
<hr />
<p><strong>ðŸ¤– AI Agent Prompt: Phase I - Update Schema Declarations with _v2
Suffix</strong></p>
<div class="highlight"><pre><span></span><code>You are updating DataJoint schema declarations for 2.0 migration testing.

TASK: Add _v2 suffix to all dj.schema() calls for parallel testing.

CONTEXT:
- Branch: pre/v2.0 (just created)
- Production schemas on main branch remain unchanged
- _v2 schemas will be empty until table definitions are converted
- This enables side-by-side testing without affecting production

STEPS:

1. Find all schema declarations:
   grep -rn &quot;dj.schema\|dj.Schema&quot; --include=&quot;*.py&quot; .

2. For EACH schema declaration, add _v2 suffix:
   OLD: schema = dj.schema(&#39;my_pipeline&#39;)
   NEW: schema = dj.schema(&#39;my_pipeline_v2&#39;)

3. Preserve all other arguments:
   OLD: schema = dj.schema(&#39;sessions&#39;, locals())
   NEW: schema = dj.schema(&#39;sessions_v2&#39;, locals())

   OLD: schema = dj.schema(&#39;analysis&#39;, create_schema=True)
   NEW: schema = dj.schema(&#39;analysis_v2&#39;, create_schema=True)

4. Update any string references to schema names:
   OLD: conn.query(&quot;USE my_pipeline&quot;)
   NEW: conn.query(&quot;USE my_pipeline_v2&quot;)

   OLD: if schema_name == &#39;my_pipeline&#39;:
   NEW: if schema_name == &#39;my_pipeline_v2&#39;:

NAMING CONVENTION:

- my_pipeline â†’ my_pipeline_v2
- sessions â†’ sessions_v2
- ephys_pipeline â†’ ephys_pipeline_v2
- lab.mouse â†’ lab.mouse_v2

VERIFICATION:

After updating, verify:
- All dj.schema() calls have _v2 suffix
- No hard-coded schema names without _v2 suffix
- No duplicate schema names (each should be unique)

COMMIT:

git add -A
git commit -m &quot;feat(phase-i): add _v2 suffix to all schema declarations

- Update all dj.schema() calls to use _v2 suffix
- Enables parallel testing without affecting production schemas
- Production schemas on main branch remain unchanged

Schemas updated:
- my_pipeline â†’ my_pipeline_v2
- [list other schemas...]&quot;
</code></pre></div>
<hr />
<h4 id="verify-schema-name-changes">Verify Schema Name Changes<a class="headerlink" href="#verify-schema-name-changes" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dj</span>

<span class="c1"># Test connection (should work before any tables created)</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ“ Connected to database&quot;</span><span class="p">)</span>

<span class="c1"># At this point, _v2 schemas don&#39;t exist yet</span>
<span class="c1"># They will be created in Step 5 when table definitions are applied</span>
</code></pre></div>
<h4 id="commit-schema-declaration-changes">Commit Schema Declaration Changes<a class="headerlink" href="#commit-schema-declaration-changes" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>add<span class="w"> </span>-A
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat(phase-i): add _v2 suffix to all schema declarations</span>

<span class="s2">- Update all dj.schema() calls to use _v2 suffix</span>
<span class="s2">- Enables parallel testing without affecting production schemas</span>
<span class="s2">- Next: configure stores and convert table definitions&quot;</span>
</code></pre></div>
<p><strong>Next steps:</strong></p>
<ul>
<li>Step 4: Configure object stores (if applicable)</li>
<li>Step 5: Convert table definitions to 2.0 syntax</li>
<li>When table definitions are applied, <code>_v2</code> schemas will be created</li>
</ul>
<h3 id="step-4-configure-datajoint-20">Step 4: Configure DataJoint 2.0<a class="headerlink" href="#step-4-configure-datajoint-20" title="Permanent link">&para;</a></h3>
<p>Create new configuration files for 2.0.</p>
<p><strong>Note:</strong> Schema declarations already updated in Step 3 with <code>_v2</code> suffix.
Now configure database connection and stores.</p>
<h4 id="background-configuration-changes">Background: Configuration Changes<a class="headerlink" href="#background-configuration-changes" title="Permanent link">&para;</a></h4>
<p>DataJoint 2.0 uses:</p>
<ul>
<li><strong><code>.secrets/datajoint.json</code></strong> for credentials (gitignored)</li>
<li><strong><code>datajoint.json</code></strong> for non-sensitive settings (checked in)</li>
<li><strong><code>stores.*</code></strong> instead of <code>external.*</code></li>
</ul>
<p><strong>Learn more:</strong> <a href="../../reference/configuration/">Configuration Reference</a></p>
<h4 id="create-configuration-files">Create Configuration Files<a class="headerlink" href="#create-configuration-files" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Create .secrets directory</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>.secrets
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;.secrets/&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>.gitignore

<span class="c1"># Create template</span>
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import datajoint as dj; dj.config.save_template()&quot;</span>
</code></pre></div>
<p><strong>Edit <code>.secrets/datajoint.json</code>:</strong>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;database.host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;your-database-host&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;database.user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;your-username&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;database.password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;your-password&quot;</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Edit <code>datajoint.json</code>:</strong>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;loglevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;safemode&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;display.limit&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;display.width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;display.show_tuple_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="verify-connection">Verify Connection<a class="headerlink" href="#verify-connection" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dj</span>

<span class="c1"># Test connection</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Connected to </span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_info</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="step-5-configure-test-object-stores-if-applicable">Step 5: Configure Test Object Stores (If Applicable)<a class="headerlink" href="#step-5-configure-test-object-stores-if-applicable" title="Permanent link">&para;</a></h3>
<p><strong>Skip this step if:</strong> Your legacy pipeline uses only in-table storage (<code>longblob</code>, <code>mediumblob</code>, <code>blob</code>, <code>attach</code>). You can skip to Step 6.</p>
<p><strong>Configure test stores if:</strong> Your legacy pipeline uses pre-2.0 in-store formats:</p>
<ul>
<li><code>blob@store</code> (hash-addressed blobs in object store)</li>
<li><code>attach@store</code> (hash-addressed attachments in object store)</li>
<li><code>filepath@store</code> (filepath references to external files)</li>
</ul>
<p><strong>Note:</strong> <code>&lt;npy@&gt;</code> and <code>&lt;object@&gt;</code> are NEW in 2.0 (schema-addressed storage). They have no legacy equivalent and don't need migration. Adopt them in Phase IV for new features.</p>
<h4 id="background-pre-20-implicit-vs-20-explicit-codecs">Background: pre-2.0 Implicit vs 2.0 Explicit Codecs<a class="headerlink" href="#background-pre-20-implicit-vs-20-explicit-codecs" title="Permanent link">&para;</a></h4>
<p><strong>pre-2.0 implicit serialization:</strong></p>
<ul>
<li><code>longblob</code> â†’ automatic Python object serialization (pickle)</li>
<li><code>mediumblob</code> â†’ automatic Python object serialization (pickle)</li>
<li><code>blob</code> â†’ automatic Python object serialization (pickle)</li>
<li>No explicit codec choice - serialization was built-in</li>
</ul>
<p><strong>2.0 explicit codecs:</strong></p>
<ul>
<li><code>&lt;blob&gt;</code> â†’ explicit Python object serialization (same behavior, now explicit)</li>
<li><code>&lt;attach&gt;</code> â†’ explicit file attachment (was separate feature)</li>
<li>Legacy in-store formats converted to explicit <code>&lt;blob@&gt;</code>, <code>&lt;attach@&gt;</code>, <code>&lt;filepath@&gt;</code> syntax</li>
</ul>
<h4 id="background-unified-stores">Background: Unified Stores<a class="headerlink" href="#background-unified-stores" title="Permanent link">&para;</a></h4>
<p>2.0 uses <strong>unified stores</strong> configuration:</p>
<ul>
<li>Single <code>stores.*</code> config for all storage types (hash-addressed + schema-addressed + filepath)</li>
<li>Named stores with <code>default</code> pointer</li>
<li>Supports multiple stores with different backends</li>
</ul>
<p><strong>Learn more:</strong> <a href="../configure-storage/">Configure Object Storage</a> Â· <a href="../../reference/specs/object-store-configuration/">Object Store Configuration Spec</a></p>
<h4 id="configure-test-stores">Configure Test Stores<a class="headerlink" href="#configure-test-stores" title="Permanent link">&para;</a></h4>
<p><strong>Edit <code>datajoint.json</code> to use test directories:</strong>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stores&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/v2_test_stores/main&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Note:</strong> Use separate test locations (e.g., <code>/data/v2_test_stores/</code>) to avoid conflicts with production stores.</p>
<p><strong>For multiple test stores:</strong>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stores&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filepath_default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/v2_test_stores/main&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;raw_data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/v2_test_stores/raw&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>For cloud storage (using test bucket/prefix):</strong>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stores&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s3_store&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;s3_store&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s3&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s3.amazonaws.com&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;bucket&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-datajoint-test-bucket&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;v2-test&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Store credentials in <code>.secrets/stores.s3_store.access_key</code> and
<code>.secrets/stores.s3_store.secret_key</code>:</strong>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;YOUR_ACCESS_KEY&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>.secrets/stores.s3_store.access_key
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;YOUR_SECRET_KEY&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>.secrets/stores.s3_store.secret_key
</code></pre></div></p>
<h4 id="ai-agent-prompt-configure-and-test-stores">AI Agent Prompt: Configure and Test Stores<a class="headerlink" href="#ai-agent-prompt-configure-and-test-stores" title="Permanent link">&para;</a></h4>
<hr />
<p><strong>ðŸ¤– AI Agent Prompt: Phase I - Configure Test Stores and Verify Codecs</strong></p>
<div class="highlight"><pre><span></span><code>You are configuring test object stores for DataJoint 2.0 migration.

TASK: Set up test stores and verify all in-store codecs work correctly
before migrating production data.

CONTEXT:
- Phase I uses TEST stores (separate from production)
- Testing verifies codecs work with legacy schema structure
- File organization must match expectations
- Production data migration happens in Phase III

STEPS:

1. Configure test stores in datajoint.json:
   - Use test locations (e.g., /data/v2_test_stores/)
   - For cloud: use test bucket or prefix (e.g., &quot;v2-test&quot;)
   - Configure hash_prefix, schema_prefix, filepath_prefix if needed

2. Store credentials in .secrets/ directory:
   - Create .secrets/stores.&lt;name&gt;.access_key (S3/GCS/Azure)
   - Create .secrets/stores.&lt;name&gt;.secret_key (S3)
   - Verify .secrets/ is gitignored

3. Test ALL in-store codecs from legacy schema:
   - &lt;blob@store&gt; (hash-addressed blob storage)
   - &lt;attach@store&gt; (hash-addressed attachments)
   - &lt;filepath@store&gt; (filepath references)

4. Create test table with all three codecs:
   ```python
   @schema
   class StoreTest(dj.Manual):
       definition = &quot;&quot;&quot;
       test_id : int
       ---
       blob_data : &lt;blob@&gt;
       attach_data : &lt;attach@&gt;
       filepath_data : &lt;filepath@&gt;
       &quot;&quot;&quot;
   ```

5. Insert test data and verify:
   - Insert sample data for each codec
   - Fetch data back successfully
   - Verify files appear at expected paths

6. Understand hash-addressed storage structure:
   {location}/{hash_prefix}/{schema_name}/{hash}[.ext]

   With subfolding [2, 2]:
   {location}/{hash_prefix}/{schema_name}/{h1}{h2}/{h3}{h4}/{hash}[.ext]

   Properties:
   - Immutable (content-addressed)
   - Deduplicated (same content â†’ same path)
   - Integrity (hash validates content)

7. Verify file organization meets expectations:
   - Check files exist at {location}/{hash_prefix}/{schema}/
   - Verify subfolding structure if configured
   - Confirm filepath references work correctly

8. Clean up test:
   - Delete test data
   - Drop test schema
   - Verify no errors during cleanup

HASH-ADDRESSED STORAGE:

Understanding the hash-addressed section is critical for migration:

- Path format: {location}/{hash_prefix}/{schema}/{hash}
- Hash computed from serialized content (Blake2b)
- Hash encoded as base32 (lowercase, no padding)
- Subfolding splits hash into directory levels
- Same content always produces same path (deduplication)

Example with hash_prefix=&quot;_hash&quot;, subfolding=[2,2]:
  /data/store/_hash/my_schema/ab/cd/abcdef123456...

Learn more: Object Store Configuration Spec
(../reference/specs/object-store-configuration.md#hash-addressed-storage)

VERIFICATION:

- [ ] Test stores configured in datajoint.json
- [ ] Credentials stored in .secrets/ (not committed)
- [ ] Connection to test stores successful
- [ ] &lt;blob@&gt; codec tested and working
- [ ] &lt;attach@&gt; codec tested and working
- [ ] &lt;filepath@&gt; codec tested and working
- [ ] Files appear at expected locations
- [ ] Hash-addressed structure understood
- [ ] Test cleanup successful

REPORT:

Test results for store configuration:
- Store names: [list configured stores]
- Store protocol: [file/s3/gcs/azure]
- Store location: [test path/bucket]
- Hash prefix: [configured value]
- Codecs tested: [blob@, attach@, filepath@]
- Files verified at: [example paths]
- Issues found: [any errors or unexpected behavior]

COMMIT MESSAGE:
&quot;feat(phase-i): configure test stores and verify codecs

- Configure test stores with [protocol] at [location]
- Store credentials in .secrets/ directory
- Test all in-store codecs: blob@, attach@, filepath@
- Verify hash-addressed file organization
- Confirm codecs work with legacy schema structure

Test stores ready for table definition conversion.&quot;
</code></pre></div>
<hr />
<h4 id="test-in-store-codecs">Test In-Store Codecs<a class="headerlink" href="#test-in-store-codecs" title="Permanent link">&para;</a></h4>
<p>After configuring test stores, verify that in-store codecs work correctly
and understand the file organization.</p>
<p><strong>Create test table with all in-store codecs:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dj</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create test schema</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;test_stores_v2&#39;</span><span class="p">)</span>

<span class="nd">@schema</span>
<span class="k">class</span><span class="w"> </span><span class="nc">StoreTest</span><span class="p">(</span><span class="n">dj</span><span class="o">.</span><span class="n">Manual</span><span class="p">):</span>
    <span class="n">definition</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    test_id : int</span>
<span class="s2">    ---</span>
<span class="s2">    blob_data : &lt;blob@&gt;          # Hash-addressed blob</span>
<span class="s2">    attach_data : &lt;attach@&gt;      # Hash-addressed attachment</span>
<span class="s2">    filepath_data : &lt;filepath@&gt;  # Filepath reference</span>
<span class="s2">    &quot;&quot;&quot;</span>

<span class="c1"># Test data</span>
<span class="n">test_blob</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
<span class="n">test_attach</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="s1">&#39;test attachment&#39;</span><span class="p">}</span>

<span class="c1"># For filepath, create test file first</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">temp_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
<span class="n">test_file_path</span> <span class="o">=</span> <span class="s1">&#39;test_data/sample.txt&#39;</span>
<span class="n">full_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">dj</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;stores&#39;</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">][</span><span class="s1">&#39;location&#39;</span><span class="p">],</span>
    <span class="n">test_file_path</span>
<span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">full_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;test content&#39;</span><span class="p">)</span>

<span class="c1"># Insert test data</span>
<span class="n">StoreTest</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span>
    <span class="s1">&#39;test_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;blob_data&#39;</span><span class="p">:</span> <span class="n">test_blob</span><span class="p">,</span>
    <span class="s1">&#39;attach_data&#39;</span><span class="p">:</span> <span class="n">test_attach</span><span class="p">,</span>
    <span class="s1">&#39;filepath_data&#39;</span><span class="p">:</span> <span class="n">test_file_path</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ“ Test data inserted successfully&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Verify file organization:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Fetch and verify</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">StoreTest</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s1">&#39;test_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">fetch1</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ blob_data: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;blob_data&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ attach_data: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;attach_data&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ filepath_data: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;filepath_data&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Inspect hash-addressed file organization</span>
<span class="n">store_spec</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_store_spec</span><span class="p">()</span>
<span class="n">hash_prefix</span> <span class="o">=</span> <span class="n">store_spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hash_prefix&#39;</span><span class="p">,</span> <span class="s1">&#39;_hash&#39;</span><span class="p">)</span>
<span class="n">location</span> <span class="o">=</span> <span class="n">store_spec</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Store organization:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Location: </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Hash prefix: </span><span class="si">{</span><span class="n">hash_prefix</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Expected structure: </span><span class="si">{</span><span class="n">hash_prefix</span><span class="si">}</span><span class="s2">/</span><span class="se">{{</span><span class="s2">schema</span><span class="se">}}</span><span class="s2">/</span><span class="se">{{</span><span class="s2">hash</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Verify files exist at:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">hash_prefix</span><span class="si">}</span><span class="s2">/test_stores_v2/&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Review hash-addressed storage structure:</strong></p>
<p>Hash-addressed storage (<code>&lt;blob@&gt;</code>, <code>&lt;attach@&gt;</code>) uses content-based paths:</p>
<div class="highlight"><pre><span></span><code>{location}/{hash_prefix}/{schema_name}/{hash}[.ext]
</code></pre></div>
<p>With subfolding enabled (e.g., <code>[2, 2]</code>):</p>
<div class="highlight"><pre><span></span><code>{location}/{hash_prefix}/{schema_name}/{h1}{h2}/{h3}{h4}/{hash}[.ext]
</code></pre></div>
<p><strong>Properties:</strong></p>
<ul>
<li><strong>Immutable</strong>: Content defines path, cannot be changed</li>
<li><strong>Deduplicated</strong>: Identical content stored once</li>
<li><strong>Integrity</strong>: Hash validates content on retrieval</li>
</ul>
<p><strong>Learn more:</strong> [Object Store Configuration â€” Hash-Addressed Storage]
(../reference/specs/object-store-configuration.md#hash-addressed-storage)</p>
<p><strong>Cleanup test:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remove test data</span>
<span class="p">(</span><span class="n">StoreTest</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s1">&#39;test_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="n">schema</span><span class="o">.</span><span class="n">drop</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ“ Test cleanup complete&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="step-6-convert-table-definitions">Step 6: Convert Table Definitions<a class="headerlink" href="#step-6-convert-table-definitions" title="Permanent link">&para;</a></h3>
<p>Update table definitions in topological order (tables before their dependents).</p>
<p><strong>Note:</strong> Schema declarations already updated to <code>_v2</code> suffix in Step 3.</p>
<h4 id="background-type-syntax-changes">Background: Type Syntax Changes<a class="headerlink" href="#background-type-syntax-changes" title="Permanent link">&para;</a></h4>
<p>Convert ALL types and codecs in Phase I:</p>
<p><strong>Integer and Float Types:</strong></p>
<table>
<thead>
<tr>
<th>pre-2.0</th>
<th>2.0</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>int unsigned</code></td>
<td><code>int64</code></td>
<td>Core type</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>int32</code></td>
<td>Core type</td>
</tr>
<tr>
<td><code>smallint unsigned</code></td>
<td><code>int32</code></td>
<td>Core type</td>
</tr>
<tr>
<td><code>tinyint unsigned</code></td>
<td><code>int16</code></td>
<td>Core type</td>
</tr>
<tr>
<td><code>bigint unsigned</code></td>
<td><code>int64</code></td>
<td>Core type</td>
</tr>
<tr>
<td><code>float</code></td>
<td><code>float32</code></td>
<td>Core type</td>
</tr>
<tr>
<td><code>double</code></td>
<td><code>float64</code></td>
<td>Core type</td>
</tr>
</tbody>
</table>
<p><strong>String, Date, and Structured Types:</strong></p>
<table>
<thead>
<tr>
<th>pre-2.0</th>
<th>2.0</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>varchar(N)</code>, <code>char(N)</code></td>
<td>Unchanged</td>
<td>Core types</td>
</tr>
<tr>
<td><code>date</code></td>
<td>Unchanged</td>
<td>Core type</td>
</tr>
<tr>
<td><code>enum('a', 'b')</code></td>
<td>Unchanged</td>
<td>Core type</td>
</tr>
<tr>
<td><code>bool</code>, <code>boolean</code></td>
<td><code>bool</code></td>
<td>Core type (MySQL stores as tinyint(1))</td>
</tr>
<tr>
<td><code>datetime</code></td>
<td><code>datetime</code></td>
<td>Core type; UTC standard in 2.0</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>datetime</code></td>
<td><strong>Ask user:</strong> Review timezone convention, convert to UTC datetime</td>
</tr>
<tr>
<td><code>json</code></td>
<td><code>json</code></td>
<td>Core type (was available but underdocumented)</td>
</tr>
<tr>
<td><code>uuid</code></td>
<td><code>uuid</code></td>
<td>Core type (widely used in legacy)</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>varchar(N)</code> or keep as native</td>
<td><strong>Native type:</strong> Consider migrating to <code>varchar(n)</code></td>
</tr>
<tr>
<td><code>time</code></td>
<td><code>datetime</code> or keep as native</td>
<td><strong>Native type:</strong> Consider using <code>datetime</code></td>
</tr>
<tr>
<td><code>tinyint(1)</code></td>
<td><code>bool</code> or <code>int16</code></td>
<td><strong>Ask user:</strong> was this boolean or small integer?</td>
</tr>
</tbody>
</table>
<p><strong>Codecs:</strong></p>
<table>
<thead>
<tr>
<th>pre-2.0</th>
<th>2.0</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>longblob</code></td>
<td><code>&lt;blob&gt;</code></td>
<td>Codec (in-table)</td>
</tr>
<tr>
<td><code>attach</code></td>
<td><code>&lt;attach&gt;</code></td>
<td>Codec (in-table)</td>
</tr>
<tr>
<td><code>blob@store</code></td>
<td><code>&lt;blob@store&gt;</code></td>
<td>Codec (in-store)</td>
</tr>
<tr>
<td><code>attach@store</code></td>
<td><code>&lt;attach@store&gt;</code></td>
<td>Codec (in-store)</td>
</tr>
<tr>
<td><code>filepath@store</code></td>
<td><code>&lt;filepath@store&gt;</code></td>
<td>Codec (in-store)</td>
</tr>
</tbody>
</table>
<p><strong>Important Notes:</strong></p>
<ul>
<li><strong>Core vs Native Types:</strong> DataJoint 2.0 distinguishes <strong>core types</strong> (portable, standardized) from <strong>native types</strong> (backend-specific). Core types are preferred. Native types like <code>text</code> and <code>time</code> are allowed but discouragedâ€”they may generate warnings and lack portability guarantees.</li>
</ul>
<ul>
<li><strong>Datetime/Timestamp:</strong> DataJoint 2.0 adopts <strong>UTC as the standard for all datetime storage</strong>. The database stores UTC; timezones are handled by application front-ends and client APIs. For <code>timestamp</code> columns, review your existing timezone conventionâ€”you may need data conversion. We recommend adopting UTC throughout your pipeline and converting <code>timestamp</code> to <code>datetime</code>.</li>
</ul>
<ul>
<li><strong>Bool:</strong> Legacy DataJoint supported <code>bool</code> and <code>boolean</code> types (MySQL stores as <code>tinyint(1)</code>). Keep as <code>bool</code> in 2.0. Only explicit <code>tinyint(1)</code> declarations need review:<ul>
<li>If used for boolean semantics (yes/no, active/inactive) â†’ <code>bool</code></li>
<li>If used for small integers (counts, indices 0-255) â†’ <code>int16</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>Text Type:</strong> <code>text</code> is a native MySQL type, not a core type. Consider migrating to <code>varchar(n)</code> with appropriate length. If your text truly needs unlimited length, you can keep <code>text</code> as a native type (will generate a warning).</li>
</ul>
<ul>
<li><strong>Time Type:</strong> <code>time</code> is a native MySQL type with no core equivalent. We recommend migrating to <code>datetime</code> (which can represent both date and time components). If you only need time-of-day without date, you can keep <code>time</code> as a native type (will generate a warning).</li>
</ul>
<ul>
<li><strong>JSON:</strong> Core type that was available in pre-2.0 but underdocumented. Many users serialized JSON into blobs. If you have custom JSON serialization in blobs, you can migrate to native <code>json</code> type (optional).</li>
</ul>
<ul>
<li><strong>Enum:</strong> Core typeâ€”no changes needed.</li>
</ul>
<ul>
<li><strong>In-store codecs:</strong> Code is converted in Phase I using test stores. Production data migration happens in Phase III.</li>
</ul>
<p><strong>Learn more:</strong> <a href="../../reference/specs/type-system/">Type System Reference</a> Â· <a href="../../reference/definition-syntax/">Definition Syntax</a></p>
<h4 id="ai-agent-prompt-convert-table-definitions">AI Agent Prompt: Convert Table Definitions<a class="headerlink" href="#ai-agent-prompt-convert-table-definitions" title="Permanent link">&para;</a></h4>
<p>Use this prompt with your AI coding assistant:</p>
<hr />
<p><strong>ðŸ¤– AI Agent Prompt: Phase I - Table Definition Conversion</strong></p>
<div class="highlight"><pre><span></span><code>You are converting DataJoint pre-2.0 table definitions to 2.0 syntax.

TASK: Update all table definitions in this repository to DataJoint 2.0 type syntax.

CONTEXT:

- We are on branch: pre/v2.0
- Production (main branch) remains on pre-2.0
- Schema declarations ALREADY updated with _v2 suffix (Step 3)
- Now converting table definitions to match
- Schemas will be created empty when definitions are applied

SCOPE - PHASE I:

1. Convert ALL type syntax to 2.0 core types
2. Convert ALL legacy codecs (in-table AND in-store)
   - In-table: longblob â†’ &lt;blob&gt;, mediumblob â†’ &lt;blob&gt;, attach â†’ &lt;attach&gt;
   - In-store (legacy only): blob@store â†’ &lt;blob@store&gt;, attach@store â†’ &lt;attach@store&gt;, filepath@store â†’ &lt;filepath@store&gt;
3. Code will use TEST stores configured in datajoint.json
4. Do NOT add new 2.0 codecs (&lt;npy@&gt;, &lt;object@&gt;) - these are for Phase IV adoption
5. Production data migration happens in Phase III (code is complete after Phase I)

TYPE CONVERSIONS:

Core Types (Integer and Float):
  int unsigned â†’ int64
  int â†’ int32
  smallint unsigned â†’ int32
  smallint â†’ int16
  tinyint unsigned â†’ int16
  tinyint â†’ int8
  bigint unsigned â†’ int64
  bigint â†’ int64
  float â†’ float32
  double â†’ float64
  decimal(M,D) â†’ decimal(M,D)  # unchanged

Core Types (String and Date):
  varchar(N) â†’ varchar(N)  # unchanged (core type)
  char(N) â†’ char(N)  # unchanged (core type)
  date â†’ date  # unchanged (core type)
  enum(&#39;a&#39;, &#39;b&#39;) â†’ enum(&#39;a&#39;, &#39;b&#39;)  # unchanged (core type)
  bool â†’ bool  # unchanged (core type, MySQL stores as tinyint(1))
  boolean â†’ bool  # unchanged (core type, MySQL stores as tinyint(1))
  datetime â†’ datetime  # unchanged (core type)

Core Types (Structured Data):
  json â†’ json  # unchanged (core type, was available but underdocumented in pre-2.0)
  uuid â†’ uuid  # unchanged (core type, widely used in pre-2.0)

Native Types (Discouraged but Allowed):
  text â†’ Consider varchar(N) with appropriate length, or keep as native type
  time â†’ Consider datetime (can represent date+time), or keep as native type

Special Cases - REQUIRE USER REVIEW:

  tinyint(1) â†’ ASK USER: bool or int16?
    Note: Legacy DataJoint had bool/boolean types. Only explicit tinyint(1) needs review.
    - Boolean semantics (yes/no, active/inactive) â†’ bool
    - Small integer (counts, indices 0-255) â†’ int16
    Example:
      is_active : tinyint(1)  # Boolean semantics â†’ bool
      priority : tinyint(1)   # 0-10 scale â†’ int16
      has_data : bool         # Already bool â†’ keep as bool

  timestamp â†’ ASK USER about timezone convention, then convert to datetime
    Example:
      created_at : timestamp  # pre-2.0 (UNKNOWN timezone convention)
      created_at : datetime   # 2.0 (UTC standard)

IMPORTANT - Datetime and Timestamp Conversion:

DataJoint 2.0 adopts UTC as the standard for all datetime storage (no timezone information).
The database stores UTC; timezones are handled by application front-ends and client APIs.

Conversion rules:

- datetime â†’ Keep as datetime (assume UTC, core type)
- timestamp â†’ ASK USER about timezone convention, then convert to datetime
- date â†’ Keep as date (core type)
- time â†’ ASK USER: recommend datetime (core type) or keep as time (native type)

For EACH timestamp column, ASK THE USER:

1. &quot;What timezone convention was used for [column_name]?&quot;
   - UTC (no conversion needed)
   - Server local time (requires conversion to UTC)
   - Application local time (requires conversion to UTC)
   - Mixed/unknown (requires data audit)

2. &quot;Does this use MySQL&#39;s auto-update behavior (ON UPDATE CURRENT_TIMESTAMP)?&quot;
   - If yes, may need to update table schema
   - If no, application controls the value

3. After clarifying, recommend:
   - Convert type: timestamp â†’ datetime
   - If not already UTC: Add data conversion script to Phase III
   - Update application code to store UTC times
   - Handle timezone display in application front-ends and client APIs

Example conversation:
  AI: &quot;I found timestamp column &#39;session_time&#39;. What timezone was used?&quot;
  User: &quot;Server time (US/Eastern)&quot;
  AI: &quot;I recommend converting to UTC. I&#39;ll convert the type to datetime and add a
       data conversion step in Phase III to convert US/Eastern times to UTC.&quot;

Example:
  # pre-2.0
  session_time : timestamp    # Was storing US/Eastern
  event_time : timestamp      # Already UTC

  # 2.0 (after user confirmation)
  session_time : datetime     # Converted to UTC in Phase III
  event_time : datetime       # No data conversion needed

IMPORTANT - Bool Type:

Legacy DataJoint already supported bool and boolean types (MySQL stores as tinyint(1)).

Conversion rules:

- bool â†’ Keep as bool (no change)
- boolean â†’ Keep as bool (no change)
- tinyint(1) â†’ ASK USER: was this boolean or small integer?

Only explicit tinyint(1) declarations need review because:

- Legacy had bool/boolean for true/false values
- Some users explicitly used tinyint(1) for small integers (0-255)

Example:
  # pre-2.0
  is_active : bool           # Already bool â†’ no change
  enabled : boolean          # Already boolean â†’ bool
  is_valid : tinyint(1)      # ASK: Boolean semantics? â†’ bool
  n_retries : tinyint(1)     # ASK: Small integer? â†’ int16

  # 2.0
  is_active : bool           # Unchanged
  enabled : bool             # boolean â†’ bool
  is_valid : bool            # Boolean semantics
  n_retries : int16          # Small integer

IMPORTANT - Enum Types:

enum is a core typeâ€”no changes required.

Example:
  sex : enum(&#39;M&#39;, &#39;F&#39;, &#39;U&#39;)  # No change needed

IMPORTANT - JSON Type:

json is a core type that was available in pre-2.0 but underdocumented. Many users
serialized JSON into blobs. If you have custom JSON serialization in blobs, you can
migrate to native json type (optional migration, not required).

Example:
  # Optional: migrate blob with JSON to native json
  config : longblob  # Contains serialized JSON
  config : json      # Core JSON type (optional improvement)

IMPORTANT - Native Types (text and time):

text and time are NATIVE MySQL types, NOT core types. They are allowed but discouraged.

For text:

- ASK USER: What is the maximum expected length?
- Recommend migrating to varchar(n) with appropriate length (core type)
- Or keep as text (native type, will generate warning)

For time:

- ASK USER: Is this time-of-day only, or is date also relevant?
- Recommend migrating to datetime (core type, can represent date+time)
- Or keep as time (native type, will generate warning)

Example:
  # pre-2.0
  description : text           # Native type
  session_start : time         # Native type (time-of-day)

  # 2.0 (recommended)
  description : varchar(1000)  # Core type (after asking user about max length)
  session_start : datetime     # Core type (if date is also relevant)

  # 2.0 (alternative - keep native)
  description : text           # Native type (if truly unlimited length needed)
  session_start : time         # Native type (if only time-of-day needed)

In-Table Codecs:
  longblob â†’ &lt;blob&gt;
  attach â†’ &lt;attach&gt;

In-Store Codecs (LEGACY formats only - convert these):
  blob@store â†’ &lt;blob@store&gt;  # Add angle brackets
  attach@store â†’ &lt;attach@store&gt;  # Add angle brackets
  filepath@store â†’ &lt;filepath@store&gt;  # Add angle brackets

IMPORTANT - Do NOT use these during migration (NEW in 2.0):
  &lt;npy@store&gt;  # Schema-addressed storage - NEW feature
  &lt;object@store&gt;  # Schema-addressed storage - NEW feature
  # These have NO legacy equivalent
  # Adopt in Phase IV AFTER migration is complete
  # Do NOT convert existing attributes to these codecs

SCHEMA DECLARATIONS:
  OLD: schema = dj.schema(&#39;my_pipeline&#39;)
  NEW: schema = dj.schema(&#39;my_pipeline_v2&#39;)

PROCESS:
1. Identify all Python files with DataJoint schemas
2. For each schema:
   a. Update schema declaration (add _v2 suffix)
   b. Create schema on database (empty for now)
3. For each table definition in TOPOLOGICAL ORDER:
   a. Convert ALL type syntax (core types + all codecs)
   b. Verify syntax is valid
4. Test that all tables can be declared (run file to create tables)
5. Verify in-store codecs work with test stores

VERIFICATION:

- All schema declarations use _v2 suffix
- All native types converted to core types
- All codecs converted (in-table AND in-store)
- Test stores configured and accessible
- No syntax errors
- All tables create successfully (empty)

EXAMPLE CONVERSION:

# pre-2.0
schema = dj.schema(&#39;neuroscience_pipeline&#39;)

@schema
class Recording(dj.Manual):
    definition = &quot;&quot;&quot;
    recording_id : int unsigned
    ---
    sampling_rate : float
    signal : blob@raw  # pre-2.0 in-store syntax
    waveforms : blob@raw  # pre-2.0 in-store syntax
    metadata : longblob  # pre-2.0 in-table
    &quot;&quot;&quot;

# 2.0 (Phase I with test stores)
schema = dj.schema(&#39;neuroscience_pipeline_v2&#39;)

@schema
class Recording(dj.Manual):
    definition = &quot;&quot;&quot;
    recording_id : int64
    ---
    sampling_rate : float32
    signal : &lt;blob@raw&gt;  # Converted: blob@raw â†’ &lt;blob@raw&gt;
    waveforms : &lt;blob@raw&gt;  # Converted: blob@raw â†’ &lt;blob@raw&gt;
    metadata : &lt;blob&gt;  # Converted: longblob â†’ &lt;blob&gt;
    &quot;&quot;&quot;

# Phase I: Only convert existing legacy formats
# Do NOT add new codecs like &lt;npy@&gt; during migration

# If you want to adopt &lt;npy@&gt; later (Phase IV), that&#39;s a separate step:
# - After migration is complete
# - For new features or performance improvements
# - Not required for migration

REPORT:

- Schemas converted: [list with _v2 suffix]
- Tables converted: [count by schema]
- Type conversions: [count by type]
- Codecs converted:
  - In-table: [count of &lt;blob&gt;, &lt;attach&gt;]
  - In-store: [count of &lt;blob@&gt;, &lt;npy@&gt;, &lt;filepath@&gt;]
- Tables created successfully: [list]
- Test stores configured: [list store names]

COMMIT MESSAGE FORMAT:
&quot;feat(phase-i): convert table definitions to 2.0 syntax

- Update schema declarations to *_v2
- Convert native types to core types (int64, float64, etc.)
- Convert all codecs (in-table + in-store)
- Configure test stores for development/testing

Tables converted: X
Codecs converted: Y (in-table: Z, in-store: W)&quot;
</code></pre></div>
<hr />
<h3 id="step-7-convert-query-and-insert-code">Step 7: Convert Query and Insert Code<a class="headerlink" href="#step-7-convert-query-and-insert-code" title="Permanent link">&para;</a></h3>
<p>Update all DataJoint API calls to 2.0 patterns.</p>
<h4 id="background-api-changes">Background: API Changes<a class="headerlink" href="#background-api-changes" title="Permanent link">&para;</a></h4>
<p><strong>Fetch API:</strong></p>
<ul>
<li><code>fetch()</code> â†’ <code>to_arrays()</code> (recarray-like) or <code>to_dicts()</code> (list of dicts)</li>
<li><code>fetch(..., format="frame")</code> â†’ <code>to_pandas()</code> (pandas DataFrame)</li>
<li><code>fetch('attr1', 'attr2')</code> â†’ <code>to_arrays('attr1', 'attr2')</code> (returns tuple)</li>
<li><code>fetch1()</code> â†’ unchanged (still returns dict for single row)</li>
</ul>
<p><strong>Update Method:</strong></p>
<ul>
<li><code>(table &amp; key)._update('attr', val)</code> â†’ <code>table.update1({**key, 'attr': val})</code></li>
</ul>
<p><strong>Join Operators:</strong></p>
<ul>
<li><code>table1 @ table2</code> â†’ <code>table1 * table2</code> (natural join with semantic checks enabled)</li>
<li><code>a.join(b, left=True)</code> â†’ Consider <code>a.extend(b)</code></li>
</ul>
<p><strong>Universal Set:</strong></p>
<ul>
<li><code>dj.U('attr') &amp; table</code> â†’ Unchanged (correct pattern for projecting attributes)</li>
<li><code>dj.U('attr') * table</code> â†’ <code>table</code> (was a hack to change primary key)</li>
</ul>
<p><strong>Visualization:</strong></p>
<ul>
<li><code>dj.ERD(schema)</code> â†’ <code>dj.Diagram(schema)</code> (ERD deprecated)</li>
</ul>
<p><strong>Learn more:</strong> <a href="../../reference/specs/fetch-api/">Fetch API Reference</a> Â· <a href="../../reference/operators/">Query Operators</a></p>
<h4 id="ai-agent-prompt-convert-query-and-insert-code">AI Agent Prompt: Convert Query and Insert Code<a class="headerlink" href="#ai-agent-prompt-convert-query-and-insert-code" title="Permanent link">&para;</a></h4>
<hr />
<p><strong>ðŸ¤– AI Agent Prompt: Phase I - Query and Insert Code Conversion</strong></p>
<div class="highlight"><pre><span></span><code>You are converting DataJoint pre-2.0 query and insert code to 2.0 API.

TASK: Update all query, fetch, and insert code to use DataJoint 2.0 API
patterns.

LEARN MORE: See Fetch API Reference (../reference/specs/fetch-api.md),
Query Operators (../reference/operators.md), and Semantic Matching
(../reference/specs/semantic-matching.md).

CONTEXT:
- Branch: pre/v2.0
- Schema declarations already updated to _v2 suffix
- Table definitions already converted
- Production code on main branch unchanged

API CONVERSIONS:

1. Fetch API (always convert):
   OLD: data = table.fetch()
   NEW: data = table.to_arrays()  # recarray-like

   OLD: data = table.fetch(as_dict=True)
   NEW: data = table.to_dicts()  # list of dicts

   OLD: data = table.fetch(format=&quot;frame&quot;)
   NEW: data = table.to_pandas()  # pandas DataFrame

   OLD: data = table.fetch(&#39;attr1&#39;, &#39;attr2&#39;)
   NEW: data = table.to_arrays(&#39;attr1&#39;, &#39;attr2&#39;)  # returns tuple

   OLD: row = table.fetch1()
   NEW: row = table.fetch1()  # UNCHANGED

   OLD: keys = table.fetch1(&#39;KEY&#39;)
   NEW: keys = table.keys()  # Returns list of dicts with primary key values

   OLD: keys, a, b = table.fetch(&quot;KEY&quot;, &quot;a&quot;, &quot;b&quot;)
   NEW: a, b = table.to_arrays(&#39;a&#39;, &#39;b&#39;, include_key=True)
   # Returns tuple with keys included

2. Update Method (always convert):
   OLD: (table &amp; key)._update(&#39;attr&#39;, value)
   NEW: table.update1({**key, &#39;attr&#39;: value})

3. Join Operator (always convert):
   OLD: result = table1 @ table2
   NEW: result = table1 * table2  # Natural join WITH semantic checks

   IMPORTANT: The @ operator bypassed semantic checks. The * operator
   enables semantic checks by default. If semantic checks fail,
   INVESTIGATEâ€”this may reveal errors in your schema or data.

   For left joins:
   OLD: result = a.join(b, left=True)
   NEW: result = a.extend(b)  # Consider using extend for left joins

4. Universal Set (CHECK - distinguish correct from hack):
   CORRECT (unchanged):
   result = dj.U(&#39;attr&#39;) &amp; table  # Projects specific attributes, unchanged

   HACK (always refactor):
   OLD: result = dj.U(&#39;attr&#39;) * table  # Was hack to change primary key
   NEW: result = table  # Simply use table directly

   Note: The * operator with dj.U() was a hack. Replace with just table.

5. Insert (CHANGED - requires named keys):
   OLD: table.insert([(1, &#39;Alice&#39;), (2, &#39;Bob&#39;)])  # Positional tuples
   NEW: table.insert([{&#39;id&#39;: 1, &#39;name&#39;: &#39;Alice&#39;},
                      {&#39;id&#39;: 2, &#39;name&#39;: &#39;Bob&#39;}])  # Dicts

   DataJoint 2.0 requires named key-value mappings for insert:
   - Dicts (most common)
   - DataFrames
   - Other DataJoint queries

   Positional tuples/lists are NO LONGER SUPPORTED.

6. Delete (unchanged):
   (table &amp; key).delete()  # unchanged
   (table &amp; restriction).delete()  # unchanged

PROCESS:
1. Find all Python files with DataJoint code
2. For each file:
   a. Search for fetch patterns
   b. Replace with 2.0 equivalents
   c. Search for update patterns
   d. Replace with update1()
   e. Search for @ operator (replace with * for natural join)
   f. Search for .join(x, left=True) patterns (consider .extend(x))
   g. Search for dj.U() * patterns (replace with just table)
   h. Verify dj.U() &amp; patterns remain unchanged
3. Run syntax checks
4. Run existing tests if available
5. If semantic checks fail after @ â†’ * conversion, investigate schema/data

VERIFICATION:

- No .fetch() calls remaining (except fetch1)
- No .fetch1(&#39;KEY&#39;) calls remaining (replaced with .keys())
- No ._update() calls remaining
- No @ operator between tables
- dj.U() * patterns replaced with just table
- dj.U() &amp; patterns remain unchanged
- All tests pass (if available)
- Semantic check failures investigated and resolved

COMMON PATTERNS:

Pattern 1: Fetch all as dicts
OLD: sessions = Session.fetch(as_dict=True)
NEW: sessions = Session.to_dicts()

Pattern 2: Fetch specific attributes
OLD: mouse_ids, dobs = Mouse.fetch(&#39;mouse_id&#39;, &#39;dob&#39;)
NEW: mouse_ids, dobs = Mouse.to_arrays(&#39;mouse_id&#39;, &#39;dob&#39;)

Pattern 3: Fetch as pandas DataFrame
OLD: df = Mouse.fetch(format=&quot;frame&quot;)
NEW: df = Mouse.to_pandas()

Pattern 4: Fetch single row
OLD: row = (Mouse &amp; key).fetch1()  # unchanged
NEW: row = (Mouse &amp; key).fetch1()  # unchanged

Pattern 5: Update attribute
OLD: (Session &amp; key)._update(&#39;experimenter&#39;, &#39;Alice&#39;)
NEW: Session.update1({**key, &#39;experimenter&#39;: &#39;Alice&#39;})

Pattern 6: Fetch primary keys
OLD: keys = Mouse.fetch1(&#39;KEY&#39;)
NEW: keys = Mouse.keys()

Pattern 7: Fetch with keys included
OLD: keys, weights, ages = Mouse.fetch(&quot;KEY&quot;, &quot;weight&quot;, &quot;age&quot;)
NEW: weights, ages = Mouse.to_arrays(&#39;weight&#39;, &#39;age&#39;, include_key=True)

Pattern 8: Natural join (now WITH semantic checks)
OLD: result = Neuron @ Session
NEW: result = Neuron * Session
# Semantic checks enabledâ€”may reveal schema errors

Pattern 9: Left join
OLD: result = Session.join(Experiment, left=True)
NEW: result = Session.extend(Experiment)  # Consider using extend

Pattern 10: Universal set (distinguish correct from hack)
CORRECT (unchanged):
OLD: all_dates = dj.U(&#39;session_date&#39;) &amp; Session
NEW: all_dates = dj.U(&#39;session_date&#39;) &amp; Session  # Unchanged, correct

HACK (always replace):
OLD: result = dj.U(&#39;new_pk&#39;) * Session  # Hack to change primary key
NEW: result = Session  # Simply use table directly

REPORT:

- Files modified: [list]
- fetch() â†’ to_arrays/to_dicts: [count]
- fetch(..., format=&quot;frame&quot;) â†’ to_pandas(): [count]
- fetch1(&#39;KEY&#39;) â†’ keys(): [count]
- _update() â†’ update1(): [count]
- @ â†’ * (natural join): [count]
- .join(x, left=True) â†’ .extend(x): [count]
- dj.U() * table â†’ table: [count]
- dj.U() &amp; table patterns (unchanged): [count]
- dj.ERD() â†’ dj.Diagram(): [count]
- Semantic check failures: [count and resolution]
- Tests passed: [yes/no]

COMMIT MESSAGE FORMAT:
&quot;feat(phase-i): convert query and insert code to 2.0 API

- Replace fetch() with to_arrays()/to_dicts()/to_pandas()
- Replace fetch1(&#39;KEY&#39;) with keys()
- Replace _update() with update1()
- Replace @ operator with * (enables semantic checks)
- Replace .join(x, left=True) with .extend(x)
- Replace dj.ERD() with dj.Diagram()
- Replace dj.U() * table with just table (was hack)
- Keep dj.U() &amp; table patterns unchanged (correct)
- Investigate and resolve semantic check failures

API conversions: X fetch, Y update, Z join&quot;
</code></pre></div>
<hr />
<h3 id="step-8-update-populate-methods">Step 8: Update Populate Methods<a class="headerlink" href="#step-8-update-populate-methods" title="Permanent link">&para;</a></h3>
<p><code>make()</code> methods in Computed and Imported tables use the same API patterns covered in Steps 6-7.</p>
<p><strong>Apply the following conversions to all <code>make()</code> methods:</strong></p>
<ol>
<li>
<p><strong>Fetch API conversions</strong> (from Step 7)</p>
<ul>
<li><code>fetch()</code> â†’ <code>to_arrays()</code> or <code>to_dicts()</code></li>
<li><code>fetch(..., format="frame")</code> â†’ <code>to_pandas()</code></li>
<li><code>fetch1('KEY')</code> â†’ <code>keys()</code></li>
<li>All other fetch patterns</li>
</ul>
</li>
<li>
<p><strong>Join conversions</strong> (from Step 7)</p>
<ul>
<li><code>@</code> â†’ <code>*</code> (enables semantic checks)</li>
<li><code>a.join(b, left=True)</code> â†’ <code>a.extend(b)</code></li>
<li><code>dj.U() * table</code> â†’ <code>table</code> (was a hack)</li>
</ul>
</li>
<li>
<p><strong>Insert conversions</strong> (NEW REQUIREMENT)</p>
<ul>
<li>Positional tuples NO LONGER SUPPORTED</li>
<li>Must use named key-value mappings:
   <div class="highlight"><pre><span></span><code><span class="c1"># OLD (no longer works)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">insert1</span><span class="p">((</span><span class="n">key</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">computed_value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">))</span>

<span class="c1"># NEW (required)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">insert1</span><span class="p">({</span>
    <span class="o">**</span><span class="n">key</span><span class="p">,</span>
    <span class="s1">&#39;computed_value&#39;</span><span class="p">:</span> <span class="n">computed_value</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">timestamp</span>
<span class="p">})</span>
</code></pre></div></li>
</ul>
</li>
</ol>
<p><strong>Note:</strong> Since these are the same conversions from Step 7, you can apply them in a single pass. The only additional consideration is ensuring insert statements use dicts.</p>
<hr />
<h3 id="step-9-verify-phase-i-complete">Step 9: Verify Phase I Complete<a class="headerlink" href="#step-9-verify-phase-i-complete" title="Permanent link">&para;</a></h3>
<h4 id="checklist">Checklist<a class="headerlink" href="#checklist" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>pre/v2.0</code> branch created</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> DataJoint 2.0 installed (<code>pip list | grep datajoint</code>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Configuration files created (<code>.secrets/</code>, <code>datajoint.json</code>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Test stores configured (if using in-store codecs)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> In-store codecs tested (<code>&lt;blob@&gt;</code>, <code>&lt;attach@&gt;</code>, <code>&lt;filepath@&gt;</code>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Hash-addressed file organization verified and understood</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All schema declarations use <code>_v2</code> suffix</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All table definitions use 2.0 type syntax</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All in-table codecs converted (<code>&lt;blob&gt;</code>, <code>&lt;attach&gt;</code>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All in-store codecs converted (<code>&lt;blob@&gt;</code>, <code>&lt;attach@&gt;</code>, <code>&lt;filepath@&gt;</code>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>fetch()</code> calls converted (except <code>fetch1()</code>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>fetch(..., format="frame")</code> converted to <code>to_pandas()</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>fetch1('KEY')</code> converted to <code>keys()</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>._update()</code> calls converted</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>@</code> operators converted to <code>*</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>dj.U() * table</code> patterns replaced with just <code>table</code> (was a hack)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>dj.U() &amp; table</code> patterns verified as unchanged (correct)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>dj.ERD()</code> calls converted to <code>dj.Diagram()</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All populate methods updated</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> No syntax errors</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All <code>_v2</code> schemas created (empty)</li>
</ul>
<h4 id="test-schema-creation">Test Schema Creation<a class="headerlink" href="#test-schema-creation" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Run your main module to create all tables</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">your_pipeline_v2</span>

<span class="c1"># Verify schemas exist</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dj</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">conn</span><span class="p">()</span>

<span class="n">schemas</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SHOW DATABASES LIKE &#39;%_v2&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">schemas</span><span class="p">)</span><span class="si">}</span><span class="s2"> _v2 schemas:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">schemas</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">schema</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Verify tables created</span>
<span class="k">for</span> <span class="n">schema_name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">schemas</span><span class="p">]:</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;SELECT COUNT(*) FROM information_schema.TABLES &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;WHERE TABLE_SCHEMA=&#39;</span><span class="si">{</span><span class="n">schema_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">tables</span><span class="si">}</span><span class="s2"> tables&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="commit-phase-i">Commit Phase I<a class="headerlink" href="#commit-phase-i" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Review all changes</span>
git<span class="w"> </span>status
git<span class="w"> </span>diff

<span class="c1"># Commit</span>
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: complete Phase I migration to DataJoint 2.0</span>

<span class="s2">Summary:</span>
<span class="s2">- Created _v2 schemas (empty)</span>
<span class="s2">- Converted all table definitions to 2.0 syntax</span>
<span class="s2">- Converted all query/insert code to 2.0 API</span>
<span class="s2">- Converted all populate methods</span>
<span class="s2">- Configured test stores for in-store codecs</span>
<span class="s2">- Production data migration deferred to Phase III</span>

<span class="s2">Schemas: X</span>
<span class="s2">Tables: Y</span>
<span class="s2">Code files: Z&quot;</span>

git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>pre/v2.0
</code></pre></div>
<p>âœ… <strong>Phase I Complete!</strong></p>
<p><strong>You now have:</strong></p>
<ul>
<li>2.0-compatible code on <code>pre/v2.0</code> branch</li>
<li>Empty <code>_v2</code> schemas ready for testing</li>
<li>Production still running on <code>main</code> branch with pre-2.0</li>
</ul>
<p><strong>Next:</strong> Phase II - Test with sample data</p>
<hr />
<h2 id="phase-ii-test-compatibility-and-equivalence">Phase II: Test Compatibility and Equivalence<a class="headerlink" href="#phase-ii-test-compatibility-and-equivalence" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Validate that the 2.0 pipeline produces equivalent results to the legacy pipeline.</p>
<p><strong>End state:</strong></p>
<ul>
<li>2.0 pipeline runs correctly with sample data in <code>_v2</code> schemas and test stores</li>
<li>Results are equivalent to running legacy pipeline on same data</li>
<li>Confidence that migration is correct before touching production</li>
<li>Production still untouched</li>
</ul>
<p><strong>Key principle:</strong> Test with identical data in both legacy and v2 schemas to verify equivalence.</p>
<h3 id="step-1-run-your-regular-workflow">Step 1: Run Your Regular Workflow<a class="headerlink" href="#step-1-run-your-regular-workflow" title="Permanent link">&para;</a></h3>
<p>Use your existing data entry and populate processes on the <code>_v2</code> schemas:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Import your v2 pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">your_pipeline_v2</span><span class="w"> </span><span class="kn">import</span> <span class="n">schema</span>  <span class="c1"># Points to my_pipeline_v2</span>

<span class="c1"># Follow your normal workflow:</span>
<span class="c1"># 1. Insert test data into manual tables (same process as usual)</span>
<span class="c1"># 2. Run populate on computed/imported tables (same process as usual)</span>
<span class="c1"># 3. Run any queries or analysis scripts (using 2.0 API)</span>

<span class="c1"># Example (adapt to your pipeline):</span>
<span class="c1"># YourManualTable.insert([...])  # Your usual insert process</span>
<span class="c1"># YourComputedTable.populate(display_progress=True)  # Your usual populate</span>
</code></pre></div>
<p><strong>Key points:</strong></p>
<ul>
<li>Use a <strong>representative subset</strong> of data (not full production dataset)</li>
<li>Follow your <strong>existing workflow</strong> - don't create artificial examples</li>
<li>Populate computed tables using your <strong>normal populate process</strong></li>
<li>Run any <strong>existing analysis or query scripts</strong> you have</li>
<li>Test that everything works with the 2.0 API</li>
</ul>
<h3 id="step-2-compare-with-legacy-schema-equivalence-testing">Step 2: Compare with Legacy Schema (Equivalence Testing)<a class="headerlink" href="#step-2-compare-with-legacy-schema-equivalence-testing" title="Permanent link">&para;</a></h3>
<p><strong>Critical:</strong> Run identical data through both legacy and v2 pipelines to verify equivalence.</p>
<h4 id="option-a-side-by-side-comparison">Option A: Side-by-Side Comparison<a class="headerlink" href="#option-a-side-by-side-comparison" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># compare_legacy_v2.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dj</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Import both legacy and v2 modules</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">your_pipeline</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">legacy</span>  <span class="c1"># pre-2.0 on main branch (checkout to test)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">your_pipeline_v2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">v2</span>  <span class="c1"># 2.0 on pre/v2.0 branch</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compare_results</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare query results between legacy and v2.&quot;&quot;&quot;</span>

    <span class="c1"># Insert same data into both schemas</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dob&#39;</span><span class="p">:</span> <span class="s1">&#39;2024-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;F&#39;</span><span class="p">},</span>
    <span class="p">]</span>

    <span class="n">legacy</span><span class="o">.</span><span class="n">Mouse</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">v2</span><span class="o">.</span><span class="n">Mouse</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Compare query results</span>
    <span class="n">legacy_mice</span> <span class="o">=</span> <span class="n">legacy</span><span class="o">.</span><span class="n">Mouse</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># pre-2.0 syntax</span>
    <span class="n">v2_mice</span> <span class="o">=</span> <span class="n">v2</span><span class="o">.</span><span class="n">Mouse</span><span class="o">.</span><span class="n">to_dicts</span><span class="p">()</span>  <span class="c1"># 2.0 syntax</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">legacy_mice</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">v2_mice</span><span class="p">),</span> <span class="s2">&quot;Row count mismatch!&quot;</span>

    <span class="c1"># Compare values (excluding fetch-specific artifacts)</span>
    <span class="k">for</span> <span class="n">leg</span><span class="p">,</span> <span class="n">v2_row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">legacy_mice</span><span class="p">,</span> <span class="n">v2_mice</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">leg</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">leg</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v2_row</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MISMATCH: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">leg</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">v2_row</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ“ Query results are equivalent!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compare_populate</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare populate results.&quot;&quot;&quot;</span>

    <span class="c1"># Populate both</span>
    <span class="n">legacy</span><span class="o">.</span><span class="n">Neuron</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">display_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">v2</span><span class="o">.</span><span class="n">Neuron</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">display_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Compare counts</span>
    <span class="n">legacy_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">legacy</span><span class="o">.</span><span class="n">Neuron</span><span class="p">())</span>
    <span class="n">v2_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">Neuron</span><span class="p">())</span>

    <span class="k">assert</span> <span class="n">legacy_count</span> <span class="o">==</span> <span class="n">v2_count</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Count mismatch: </span><span class="si">{</span><span class="n">legacy_count</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">v2_count</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ Populate generated same number of rows: </span><span class="si">{</span><span class="n">v2_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Compare computed values (if numeric)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="n">legacy</span><span class="o">.</span><span class="n">Neuron</span> <span class="o">&amp;</span> <span class="s1">&#39;neuron_id=0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">leg_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">legacy</span><span class="o">.</span><span class="n">Neuron</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">fetch1</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">)</span>
        <span class="n">v2_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">Neuron</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">fetch1</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leg_val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">leg_val</span><span class="p">,</span> <span class="n">v2_val</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">),</span> <span class="s2">&quot;Array values differ!&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">leg_val</span> <span class="o">==</span> <span class="n">v2_val</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Value mismatch: </span><span class="si">{</span><span class="n">leg_val</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">v2_val</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ“ Populate results are equivalent!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Comparing legacy and v2 pipelines...&quot;</span><span class="p">)</span>
    <span class="n">compare_results</span><span class="p">()</span>
    <span class="n">compare_populate</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âœ“ All equivalence tests passed!&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Run comparison:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>compare_legacy_v2.py
</code></pre></div>
<h4 id="option-b-data-copy-and-validation">Option B: Data Copy and Validation<a class="headerlink" href="#option-b-data-copy-and-validation" title="Permanent link">&para;</a></h4>
<p>If you can't easily import both modules:</p>
<ol>
<li>Copy sample data from production to both legacy test schema and <code>_v2</code> schema</li>
<li>Run populate on both</li>
<li>Use helper to compare:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datajoint.migrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">compare_query_results</span>

<span class="c1"># Compare table contents</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">compare_query_results</span><span class="p">(</span>
    <span class="n">prod_schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline&#39;</span><span class="p">,</span>
    <span class="n">test_schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline_v2&#39;</span><span class="p">,</span>
    <span class="n">table</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;row_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows match&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ— Discrepancies found:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">disc</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;discrepancies&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">disc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="step-3-run-existing-tests">Step 3: Run Existing Tests<a class="headerlink" href="#step-3-run-existing-tests" title="Permanent link">&para;</a></h3>
<p>If you have a test suite:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Run tests against _v2 schemas</span>
pytest<span class="w"> </span>tests/<span class="w"> </span>-v

<span class="c1"># Or specific test modules</span>
pytest<span class="w"> </span>tests/test_queries.py<span class="w"> </span>-v
pytest<span class="w"> </span>tests/test_populate.py<span class="w"> </span>-v
</code></pre></div>
<h3 id="step-4-document-test-results">Step 4: Document Test Results<a class="headerlink" href="#step-4-document-test-results" title="Permanent link">&para;</a></h3>
<p>Document your testing process and results:</p>
<p><strong>What to document:</strong></p>
<ul>
<li>Date of testing</li>
<li>Test data used (subset, size, representative samples)</li>
<li>Tables tested and row counts</li>
<li>Populate results (did computed tables generate expected rows?)</li>
<li>Equivalence test results (if comparing with legacy)</li>
<li>Any issues found and how they were resolved</li>
<li>Test suite results (if you have automated tests)</li>
</ul>
<p><strong>Purpose:</strong> Creates a record of validation for your team and future reference.
Useful when planning production migration in Phase III.</p>
<p>âœ… <strong>Phase II Complete!</strong></p>
<p><strong>You now have:</strong></p>
<ul>
<li>Validated 2.0 pipeline with sample data</li>
<li>Confidence in code migration</li>
<li>Test report documenting success</li>
<li>Ready to migrate production data</li>
</ul>
<p><strong>Next:</strong> Phase III - Migrate production data</p>
<hr />
<h2 id="phase-iii-migrate-production-data">Phase III: Migrate Production Data<a class="headerlink" href="#phase-iii-migrate-production-data" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Migrate production data and configure production stores. Code is complete from Phase I.</p>
<p><strong>End state:</strong></p>
<ul>
<li>Production data migrated to <code>_v2</code> schemas</li>
<li>Production stores configured (replacing test stores)</li>
<li>In-store metadata updated (UUID â†’ JSON)</li>
<li>Ready to switch production to 2.0</li>
</ul>
<p><strong>Key principle:</strong> All code changes were completed in Phase I. This phase is DATA migration only.</p>
<p><strong>Prerequisites:</strong></p>
<ul>
<li>Phase I complete (all code migrated)</li>
<li>Phase II complete (equivalence validated)</li>
<li>Production backup created</li>
<li>Production workloads quiesced</li>
</ul>
<p><strong>Options:</strong></p>
<ul>
<li><strong>Option A:</strong> Copy data, rename schemas (recommended - safest)</li>
<li><strong>Option B:</strong> In-place migration (for very large databases)</li>
<li><strong>Option C:</strong> Gradual migration with legacy compatibility</li>
</ul>
<p>Choose the option that best fits your needs.</p>
<h3 id="option-a-copy-data-and-rename-schemas-recommended">Option A: Copy Data and Rename Schemas (Recommended)<a class="headerlink" href="#option-a-copy-data-and-rename-schemas-recommended" title="Permanent link">&para;</a></h3>
<p><strong>Best for:</strong> Most pipelines, especially &lt; 1 TB</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Safe - production unchanged until final step</li>
<li>Easy rollback</li>
<li>Can practice multiple times</li>
</ul>
<p><strong>Process:</strong></p>
<h4 id="0-configure-production-stores">0. Configure Production Stores<a class="headerlink" href="#0-configure-production-stores" title="Permanent link">&para;</a></h4>
<p>Update <code>datajoint.json</code> to point to production stores (not test stores):</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stores&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/production_stores/main&quot;</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Produc</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">loca</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>For in-store data migration:</strong> You can either:</p>
<ul>
<li><strong>Keep files in place</strong> (recommended): Point to existing pre-2.0 store locations</li>
<li><strong>Copy to new location</strong>: Configure new production stores and copy files</li>
</ul>
<p><strong>Commit this change:</strong>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>add<span class="w"> </span>datajoint.json
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;config: update stores to production locations&quot;</span>
</code></pre></div></p>
<h4 id="1-backup-production">1. Backup Production<a class="headerlink" href="#1-backup-production" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Full backup</span>
mysqldump<span class="w"> </span>--all-databases<span class="w"> </span>&gt;<span class="w"> </span>backup_<span class="k">$(</span>date<span class="w"> </span>+%Y%m%d<span class="k">)</span>.sql

<span class="c1"># Or schema-specific</span>
mysqldump<span class="w"> </span>my_pipeline<span class="w"> </span>&gt;<span class="w"> </span>my_pipeline_backup_<span class="k">$(</span>date<span class="w"> </span>+%Y%m%d<span class="k">)</span>.sql
</code></pre></div>
<h4 id="2-copy-manual-table-data">2. Copy Manual Table Data<a class="headerlink" href="#2-copy-manual-table-data" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datajoint.migrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">copy_table_data</span>

<span class="c1"># Copy each manual table</span>
<span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;session&#39;</span><span class="p">,</span> <span class="s1">&#39;experimenter&#39;</span><span class="p">]</span>  <span class="c1"># Your manual tables</span>

<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">copy_table_data</span><span class="p">(</span>
        <span class="n">source_schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline&#39;</span><span class="p">,</span>
        <span class="n">dest_schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline_v2&#39;</span><span class="p">,</span>
        <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">: copied </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;rows_copied&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="3-populate-computed-tables">3. Populate Computed Tables<a class="headerlink" href="#3-populate-computed-tables" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">your_pipeline_v2</span><span class="w"> </span><span class="kn">import</span> <span class="n">Neuron</span><span class="p">,</span> <span class="n">Analysis</span>

<span class="c1"># Populate using 2.0 code</span>
<span class="n">Neuron</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">display_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Analysis</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">display_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<h4 id="4-migrate-in-store-metadata">4. Migrate In-Store Metadata<a class="headerlink" href="#4-migrate-in-store-metadata" title="Permanent link">&para;</a></h4>
<p><strong>Important:</strong> Your code already handles in-store codecs (converted in Phase I). This step just updates metadata format.</p>
<p>If you have tables using <code>&lt;blob@&gt;</code>, <code>&lt;attach@&gt;</code>, or <code>&lt;filepath@&gt;</code> codecs, migrate the storage metadata from legacy BINARY(16) UUID format to 2.0 JSON format:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datajoint.migrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">migrate_external_pointers_v2</span>

<span class="c1"># Update metadata format (UUID â†’ JSON)</span>
<span class="c1"># This does NOT move filesâ€”just updates database pointers</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">migrate_external_pointers_v2</span><span class="p">(</span>
    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline_v2&#39;</span><span class="p">,</span>
    <span class="n">table</span><span class="o">=</span><span class="s1">&#39;recording&#39;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;signal&#39;</span><span class="p">,</span>
    <span class="n">source_store</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span>  <span class="c1"># Legacy pre-2.0 store name</span>
    <span class="n">dest_store</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span>  <span class="c1"># 2.0 store name (from datajoint.json)</span>
    <span class="n">copy_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Keep files in place (recommended)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Migrated </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;rows_migrated&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> pointers&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>What this does:</strong></p>
<ul>
<li>Reads legacy BINARY(16) UUID pointers from <code>~external_*</code> hidden tables</li>
<li>Creates new JSON metadata with file path, store name, hash</li>
<li>Writes JSON to the <code>&lt;blob@store&gt;</code> column (code written in Phase I)</li>
<li>Does NOT copy files (unless <code>copy_files=True</code>)</li>
</ul>
<p><strong>Result:</strong> Files stay in place, but 2.0 code can now access them via the new codec system.</p>
<h4 id="5-validate-data-integrity">5. Validate Data Integrity<a class="headerlink" href="#5-validate-data-integrity" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datajoint.migrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">compare_query_results</span>

<span class="c1"># Compare production vs _v2</span>
<span class="n">tables_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;session&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="s1">&#39;analysis&#39;</span><span class="p">]</span>

<span class="n">all_match</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables_to_check</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">compare_query_results</span><span class="p">(</span>
        <span class="n">prod_schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline&#39;</span><span class="p">,</span>
        <span class="n">test_schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline_v2&#39;</span><span class="p">,</span>
        <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;row_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows match&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ— </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">: discrepancies found&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">disc</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;discrepancies&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">disc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">all_match</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="n">all_match</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âœ“ All tables validated! Ready for cutover.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âœ— Fix discrepancies before proceeding.&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="6-schedule-cutover">6. Schedule Cutover<a class="headerlink" href="#6-schedule-cutover" title="Permanent link">&para;</a></h4>
<p><strong>Pre-cutover checklist:</strong></p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Full backup verified</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All data copied</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All computed tables populated</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Validation passed</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Team notified</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Maintenance window scheduled</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> All pre-2.0 clients stopped</li>
</ul>
<p><strong>Execute cutover:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Rename production â†’ old</span>
<span class="k">RENAME</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline</span><span class="o">`</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline_old</span><span class="o">`</span><span class="p">;</span>

<span class="c1">-- Rename _v2 â†’ production</span>
<span class="k">RENAME</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline_v2</span><span class="o">`</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline</span><span class="o">`</span><span class="p">;</span>
</code></pre></div>
<p><strong>Update code:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># On pre/v2.0 branch, update schema names back</span>
sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="s1">&#39;s/_v2//g&#39;</span><span class="w"> </span>your_pipeline/*.py

git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;chore: remove _v2 suffix for production&quot;</span>

<span class="c1"># Merge to main</span>
git<span class="w"> </span>checkout<span class="w"> </span>main
git<span class="w"> </span>merge<span class="w"> </span>pre/v2.0
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>main

<span class="c1"># Deploy updated code</span>
</code></pre></div>
<h4 id="7-verify-production">7. Verify Production<a class="headerlink" href="#7-verify-production" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Test production after cutover</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">your_pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">schema</span><span class="p">,</span> <span class="n">Mouse</span><span class="p">,</span> <span class="n">Neuron</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mice: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">Mouse</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Neurons: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">Neuron</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Run a populate</span>
<span class="n">Neuron</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">display_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<h4 id="8-cleanup-after-1-2-weeks">8. Cleanup (After 1-2 Weeks)<a class="headerlink" href="#8-cleanup-after-1-2-weeks" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- After confirming production stable</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline_old</span><span class="o">`</span><span class="p">;</span>
</code></pre></div>
<h3 id="option-b-in-place-migration">Option B: In-Place Migration<a class="headerlink" href="#option-b-in-place-migration" title="Permanent link">&para;</a></h3>
<p><strong>Best for:</strong> Very large databases (&gt; 1 TB) where copying is impractical</p>
<p><strong>Warning:</strong> Modifies production schema directly. Test thoroughly first!</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datajoint.migrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">migrate_schema_in_place</span>

<span class="c1"># Backup first</span>
<span class="n">backup_schema</span><span class="p">(</span><span class="s1">&#39;my_pipeline&#39;</span><span class="p">,</span> <span class="s1">&#39;my_pipeline_backup_20260114&#39;</span><span class="p">)</span>

<span class="c1"># Migrate in place</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">migrate_schema_in_place</span><span class="p">(</span>
    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline&#39;</span><span class="p">,</span>
    <span class="n">backup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;update_blob_comments&#39;</span><span class="p">,</span>  <span class="c1"># Add :&lt;blob&gt;: markers</span>
        <span class="s1">&#39;add_lineage_table&#39;</span><span class="p">,</span>  <span class="c1"># Create ~lineage</span>
        <span class="s1">&#39;migrate_external_storage&#39;</span><span class="p">,</span>  <span class="c1"># BINARY(16) â†’ JSON</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Migrated </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;steps_completed&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> steps&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="option-c-gradual-migration-with-legacy-compatibility">Option C: Gradual Migration with Legacy Compatibility<a class="headerlink" href="#option-c-gradual-migration-with-legacy-compatibility" title="Permanent link">&para;</a></h3>
<p><strong>Best for:</strong> Pipelines that must support both pre-2.0 and 2.0 clients simultaneously</p>
<p><strong>Strategy:</strong> Create dual columns for in-store codecs</p>
<h4 id="1-add-_v2-columns">1. Add <code>_v2</code> Columns<a class="headerlink" href="#1-add-_v2-columns" title="Permanent link">&para;</a></h4>
<p>For each in-store attribute, add a corresponding <code>_v2</code> column:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Add _v2 column for in-store codec</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">recording</span><span class="o">`</span>
<span class="w">  </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="o">`</span><span class="n">signal_v2</span><span class="o">`</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;:&lt;blob@raw&gt;:signal data&#39;</span><span class="p">;</span>
</code></pre></div>
<h4 id="2-populate-_v2-columns">2. Populate <code>_v2</code> Columns<a class="headerlink" href="#2-populate-_v2-columns" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datajoint.migrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">populate_v2_columns</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">populate_v2_columns</span><span class="p">(</span>
    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;my_pipeline&#39;</span><span class="p">,</span>
    <span class="n">table</span><span class="o">=</span><span class="s1">&#39;recording&#39;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;signal&#39;</span><span class="p">,</span>
    <span class="n">v2_attribute</span><span class="o">=</span><span class="s1">&#39;signal_v2&#39;</span><span class="p">,</span>
    <span class="n">source_store</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span>
    <span class="n">dest_store</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Populated </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;rows&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> _v2 columns&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="3-update-code-to-use-_v2-columns">3. Update Code to Use <code>_v2</code> Columns<a class="headerlink" href="#3-update-code-to-use-_v2-columns" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Update table definition</span>
<span class="nd">@schema</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Recording</span><span class="p">(</span><span class="n">dj</span><span class="o">.</span><span class="n">Manual</span><span class="p">):</span>
    <span class="n">definition</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    recording_id : int64</span>
<span class="s2">    ---</span>
<span class="s2">    signal : blob@raw  # Legacy (pre-2.0 clients)</span>
<span class="s2">    signal_v2 : &lt;blob@raw&gt;  # 2.0 clients</span>
<span class="s2">    &quot;&quot;&quot;</span>
</code></pre></div>
<p><strong>Both APIs work:</strong></p>
<ul>
<li>pre-2.0 clients use <code>signal</code></li>
<li>2.0 clients use <code>signal_v2</code></li>
</ul>
<h4 id="4-final-cutover">4. Final Cutover<a class="headerlink" href="#4-final-cutover" title="Permanent link">&para;</a></h4>
<p>Once all clients upgraded to 2.0:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Drop legacy column</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">recording</span><span class="o">`</span>
<span class="w">  </span><span class="k">DROP</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="o">`</span><span class="n">signal</span><span class="o">`</span><span class="p">;</span>

<span class="c1">-- Rename _v2 to original name</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">my_pipeline</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">recording</span><span class="o">`</span>
<span class="w">  </span><span class="n">CHANGE</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="o">`</span><span class="n">signal_v2</span><span class="o">`</span><span class="w"> </span><span class="o">`</span><span class="n">signal</span><span class="o">`</span><span class="w"> </span><span class="n">JSON</span><span class="p">;</span>
</code></pre></div>
<hr />
<h2 id="phase-iv-adopt-new-features">Phase IV: Adopt New Features<a class="headerlink" href="#phase-iv-adopt-new-features" title="Permanent link">&para;</a></h2>
<p>After successful migration, adopt DataJoint 2.0 features incrementally based
on your needs. Migration is complete - these are optional enhancements.</p>
<h3 id="new-features-overview">New Features Overview<a class="headerlink" href="#new-features-overview" title="Permanent link">&para;</a></h3>
<p><strong>Schema-addressed storage</strong> (<code>&lt;npy@&gt;</code>, <code>&lt;object@&gt;</code>)
- Lazy-loading arrays with fsspec integration
- Hierarchical organization by primary key
- Mutable objects with streaming access
- See: <a href="../../tutorials/basics/06-object-storage/">Object Storage Tutorial</a></p>
<p><strong>Semantic matching</strong>
- Lineage-based join validation (enabled by default with <code>*</code> operator)
- Catches errors from incompatible data combinations
- See: <a href="../../reference/specs/semantic-matching/">Semantic Matching Spec</a></p>
<p><strong>Jobs 2.0</strong>
- Per-table job tracking (<code>~~table_name</code>)
- Priority-based populate (with <code>reserve_jobs=True</code>)
- Improved distributed computing coordination
- See: <a href="../../tutorials/advanced/distributed/">Distributed Computing Tutorial</a></p>
<p><strong>Custom codecs</strong>
- Domain-specific data types
- Extensible type system
- See: <a href="../../tutorials/advanced/custom-codecs/">Custom Codecs Tutorial</a></p>
<h3 id="learning-path">Learning Path<a class="headerlink" href="#learning-path" title="Permanent link">&para;</a></h3>
<p><strong>Start here:</strong></p>
<ol>
<li><a href="../../tutorials/basics/06-object-storage/">Object Storage Tutorial</a> -
   Learn <code>&lt;npy@&gt;</code> and <code>&lt;object@&gt;</code> for large arrays</li>
<li><a href="../../tutorials/advanced/distributed/">Distributed Computing Tutorial</a> -
   Jobs 2.0 with priority-based populate</li>
<li><a href="../../tutorials/advanced/custom-codecs/">Custom Codecs Tutorial</a> -
   Create domain-specific types</li>
</ol>
<p><strong>Reference documentation:</strong></p>
<ul>
<li><a href="../../reference/specs/object-store-configuration/">Object Store Configuration</a></li>
<li><a href="../../reference/specs/npy-codec/">NPY Codec Spec</a></li>
<li><a href="../../reference/specs/codec-api/">Codec API</a></li>
<li><a href="../../reference/specs/semantic-matching/">Semantic Matching Spec</a></li>
<li><a href="../../reference/specs/autopopulate/">AutoPopulate Spec</a></li>
</ul>
<p><strong>Adopt features incrementally:</strong></p>
<ul>
<li>Start with one table using <code>&lt;npy@&gt;</code> for large arrays</li>
<li>Test performance and workflow improvements</li>
<li>Expand to other tables as needed</li>
<li>No need to adopt all features at once</li>
</ul>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="import-errors">Import Errors<a class="headerlink" href="#import-errors" title="Permanent link">&para;</a></h3>
<p><strong>Issue:</strong> Module not found after migration</p>
<p><strong>Solution:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># Ensure all imports use datajoint namespace</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dj</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datajoint</span><span class="w"> </span><span class="kn">import</span> <span class="n">schema</span><span class="p">,</span> <span class="n">Manual</span><span class="p">,</span> <span class="n">Computed</span>
</code></pre></div></p>
<h3 id="schema-not-found">Schema Not Found<a class="headerlink" href="#schema-not-found" title="Permanent link">&para;</a></h3>
<p><strong>Issue:</strong> <code>Database 'schema_v2' doesn't exist</code></p>
<p><strong>Solution:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># Ensure schema declared and created</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="s1">&#39;schema_v2&#39;</span><span class="p">)</span>
<span class="n">schema</span><span class="o">.</span><span class="n">spawn_missing_classes</span><span class="p">()</span>
</code></pre></div></p>
<h3 id="type-syntax-errors">Type Syntax Errors<a class="headerlink" href="#type-syntax-errors" title="Permanent link">&para;</a></h3>
<p><strong>Issue:</strong> <code>Invalid type: 'int unsigned'</code></p>
<p><strong>Solution:</strong> Update to core types
<div class="highlight"><pre><span></span><code><span class="c1"># Wrong</span>
<span class="n">definition</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">id : int unsigned</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Correct</span>
<span class="n">definition</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">id : int64</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div></p>
<h3 id="external-storage-not-found">External Storage Not Found<a class="headerlink" href="#external-storage-not-found" title="Permanent link">&para;</a></h3>
<p><strong>Issue:</strong> Can't access external data after migration</p>
<p><strong>Solution:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># Ensure stores configured</span>
<span class="n">dj</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;stores.default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;main&#39;</span>
<span class="n">dj</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;stores.main.location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/data/stores&#39;</span>

<span class="c1"># Verify</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datajoint.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_store_spec</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_store_spec</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">))</span>
</code></pre></div></p>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p><strong>Phase I:</strong> Branch and code migration (~1-4 hours with AI)
- Create <code>pre/v2.0</code> branch
- Update all code to 2.0 API
- Create empty <code>_v2</code> schemas</p>
<p><strong>Phase II:</strong> Test with sample data (~1-2 days)
- Insert test data
- Validate functionality
- Test new features</p>
<p><strong>Phase III:</strong> Migrate production data (~1-7 days)
- Choose migration option
- Copy or migrate data
- Validate integrity
- Execute cutover</p>
<p><strong>Phase IV:</strong> Adopt new features (ongoing)
- Object storage
- Semantic matching
- Custom codecs
- Jobs 2.0</p>
<p><strong>Total timeline:</strong> ~1-2 weeks for most pipelines</p>
<hr />
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h2>
<p><strong>Core Documentation:</strong></p>
<ul>
<li><a href="../../explanation/type-system/">Type System Concept</a></li>
<li><a href="../../reference/configuration/">Configuration Reference</a></li>
<li><a href="../../reference/definition-syntax/">Definition Syntax</a></li>
<li><a href="../../reference/specs/fetch-api/">Fetch API Reference</a></li>
</ul>
<p><strong>Tutorials:</strong></p>
<ul>
<li><a href="../../tutorials/basics/06-object-storage/">Object Storage</a></li>
<li><a href="../../tutorials/advanced/custom-codecs/">Custom Codecs</a></li>
<li><a href="../../tutorials/advanced/distributed/">Distributed Computing</a></li>
</ul>
<p><strong>Specifications:</strong></p>
<ul>
<li><a href="../../reference/specs/type-system/">Type System Spec</a></li>
<li><a href="../../reference/specs/codec-api/">Codec API Spec</a></li>
<li><a href="../../reference/specs/object-store-configuration/">Object Store Configuration</a></li>
<li><a href="../../reference/specs/semantic-matching/">Semantic Matching</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://www.datajoint.com" target="_blank" rel="noopener" title="DataJoint" class="md-social__link">
      <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 15.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="260.479px" height="365.463px" viewBox="0 0 260.479 365.463" enable-background="new 0 0 260.479 365.463"
	 xml:space="preserve">
<g>
	<path d="M4.638,361.434c0,0,124.071-124.072,135.896-357.434c0,0,29.555,189.053,115.266,256.988
		C255.799,260.988,173.038,249.174,4.638,361.434z"/>
</g>
</svg>
    </a>
  
    
    
    
    
    <a href="https://docs.datajoint.com" target="_blank" rel="noopener" title="DataJoint Documentation" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/datajoint/datajoint-python/discussions" target="_blank" rel="noopener" title="Discussions" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M384 144c0 97.2-86 176-192 176-26.7 0-52.1-5-75.2-14l-81.6 43.2c-9.3 4.9-20.7 3.2-28.2-4.2s-9.2-18.9-4.2-28.2l35.6-67.2C14.3 220.2 0 183.6 0 144 0 46.8 86-32 192-32s192 78.8 192 176m0 368c-94.1 0-172.4-62.1-188.8-144 120-1.5 224.3-86.9 235.8-202.7 83.3 19.2 145 88.3 145 170.7 0 39.6-14.3 76.2-38.4 105.6l35.6 67.2c4.9 9.3 3.2 20.7-4.2 28.2s-18.9 9.2-28.2 4.2L459.2 498c-23.1 9-48.5 14-75.2 14"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/company/datajoint" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://twitter.com/datajoint" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/datajoint" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://hub.docker.com/u/datajoint" target="_blank" rel="noopener" title="DockerHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://pypi.org/user/datajointbot" target="_blank" rel="noopener" title="PyPI" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
    
    
    
    
    <a href="https://stackoverflow.com/questions/tagged/datajoint" target="_blank" rel="noopener" title="StackOverflow" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M291 311 95.3 269.7 87.1 309l195.7 41zm51-87L188.5 95.7 163 126.5l153.5 128.3zm-31.2 39.7L129.5 179l-16.7 36.5L294 300zM262.3 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H43V320H3v160h359.5V320h-40z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.youtube.com/@datajoint" target="_blank" rel="noopener" title="YouTube" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.indexes", "toc.follow", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://js-na1.hs-scripts.com/23133402.js"></script>
      
    
  </body>
</html>